<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="product-review"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-title>BMC Bioinformatics</journal-title><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">16613602</article-id><article-id pub-id-type="pmc">1479841</article-id><article-id pub-id-type="publisher-id">1471-2105-7-205</article-id><article-id pub-id-type="doi">10.1186/1471-2105-7-205</article-id><article-categories><subj-group subj-group-type="heading"><subject>Software</subject></subj-group></article-categories><title-group><article-title><italic>SIMAGE</italic>: <italic>si</italic>mulation of DNA-<italic>m</italic>icro<italic>a</italic>rray <italic>g</italic>ene <italic>e</italic>xpression data</article-title></title-group><contrib-group><contrib id="A1" equal-contrib="yes" corresp="yes" contrib-type="author"><name><surname>Albers</surname><given-names>Casper J</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I3">3</xref><email>c.j.albers@open.ac.uk</email></contrib><contrib id="A2" contrib-type="author"><name><surname>Jansen</surname><given-names>Ritsert C</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>r.c.jansen@rug.nl</email></contrib><contrib id="A3" contrib-type="author"><name><surname>Kok</surname><given-names>Jan</given-names></name><xref ref-type="aff" rid="I2">2</xref><email>jan.kok@rug.nl</email></contrib><contrib id="A4" contrib-type="author"><name><surname>Kuipers</surname><given-names>Oscar P</given-names></name><xref ref-type="aff" rid="I2">2</xref><email>o.p.kuipers@rug.nl</email></contrib><contrib id="A5" equal-contrib="yes" corresp="yes" contrib-type="author"><name><surname>van Hijum</surname><given-names>Sacha AFT</given-names></name><xref ref-type="aff" rid="I2">2</xref><email>s.a.f.t.van.hijum@rug.nl</email></contrib></contrib-group><aff id="I1"><label>1</label>Groningen Bioinformatics Centre, University of Groningen, Groningen Biomolecular Sciences and Biotechnology Institute, PO Box 14, 9750 AA Haren, The Netherlands</aff><aff id="I2"><label>2</label>Department of Molecular Genetics, University of Groningen, Groningen Biomolecular Sciences and Biotechnology Institute, PO Box 14, 9750 AA Haren, The Netherlands</aff><aff id="I3"><label>3</label>Department of Statistics, The Open University, Walton Hall, Milton Keynes MK7 6AA, UK</aff><pub-date pub-type="collection"><year>2006</year></pub-date><pub-date pub-type="epub"><day>13</day><month>4</month><year>2006</year></pub-date><volume>7</volume><fpage>205</fpage><lpage>205</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/7/205"/><history><date date-type="received"><day>28</day><month>2</month><year>2006</year></date><date date-type="accepted"><day>13</day><month>4</month><year>2006</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2006 Albers et al; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2006</copyright-year><copyright-holder>Albers et al; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Albers
               J
               Casper
               
               
               c.j.albers@open.ac.uk
            </dc:author><dc:title>
            SIMAGE: simulation of DNA-microarray gene expression data
         </dc:title><dc:date>2006</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 7(1): 205-. (2006)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2006)7:1&#x0003c;205&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>Simulation of DNA-microarray data serves at least three purposes: (i) optimizing the design of an intended DNA microarray experiment, (ii) comparing existing pre-processing and processing methods for best analysis of a given DNA microarray experiment, (iii) educating students, lab-workers and other researchers by making them aware of the many factors influencing DNA microarray experiments.</p></sec><sec><title>Results</title><p>Our model has multiple layers of factors influencing the experiment. The relative influence of such factors can differ significantly between labs, experiments within labs, etc. Therefore, we have added a module to roughly estimate their parameters from a given data set. This guarantees that our simulated data mimics real data as closely as possible.</p></sec><sec><title>Conclusion</title><p>We introduce a model for the simulation of dual-dye cDNA-microarray data closely resembling real data and coin the model and its software implementation "<italic>SIMAGE</italic>" which stands for <underline>si</underline>mulation of <underline>m</underline>icro<underline>a</underline>rray <underline>g</underline>ene <underline>e</underline>xpression data. The software is freely accessible at: <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.biol.rug.nl/websoftware/simage"/>.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>No two laboratories produce the same expression data when performing seemingly identical DNA microarray experiments. This is simply due to the fact that experimental conditions and factors such as growth media composition, RNA sampling methodology and scanner calibration are never exactly identical [<xref ref-type="bibr" rid="B1">1</xref>]. Even within one and the same laboratory differences in the outcome of experiments executed by different laborants can be observed [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B3">3</xref>]. These and many other factors lead to sometimes unexpected gene expression variations that can occur at several levels. Figure <xref ref-type="fig" rid="F1">1</xref> shows a schematic and simplified overview of those levels in dual-color DNA microarray data (top) as well as the effect of some of these levels on the composition of the expression signals (bottom).</p><p>It is obvious that knowledge about the properties that gene expression signals hold as shown in Figure <xref ref-type="fig" rid="F1">1</xref> is very important to any researcher. This knowledge can be used to design an optimal new DNA microarray experiment and to carry out the best analysis of that generated data set. To this end, real and simulated data has been used for a long time in data analysis workshops. And in case it is not (yet) obvious for a novice in the field, the visualization as shown in Figure <xref ref-type="fig" rid="F1">1</xref> can be of educational value. In all three cases &#x02013; design, analysis and education &#x02013; the availability of simulation software would be very helpful. It is of eminent importance that the simulated data resembles experimental data as much as possible [<xref ref-type="bibr" rid="B4">4</xref>] and, therefore, there is a need for software that can (roughly) estimate levels of variation.</p><p>Various software packages for simulating dual-color DNA microarray data have been described in the literature (Table <xref ref-type="table" rid="T1">1</xref>). Some of these packages aim at validating image analysis and spot quantification and simulate TIF-images of the visualized spots. Other software focuses on gene networks. In this paper, we present new software that fits in between these two categories: we simulate the gene expression data as it is tabulated after image analysis. In addition, we provide software that can be used to roughly estimate the levels of variation in real data. These computer programs, named <italic>SIMAGE</italic>, are freely available via a web-resource.</p></sec><sec><title>Implementation</title><sec><title>Software overview</title><p>The <italic>SIMAGE </italic>web site [<xref ref-type="bibr" rid="B5">5</xref>] consists of three parts: (i) a start page where the user may upload parameters for a simulation; (ii) a web-page where the user specifies a number of parameters, after which (iii) the results, namely simulated data (see below), are presented. Each run is assigned a unique session, which allows the user to inspect the results at any given time. <italic>SIMAGE </italic>provides the user with three types of text files containing: (i) the parameters used for the simulation. This file can, in turn, be provided to <italic>SIMAGE </italic>for future simulations; (ii) the (differential) gene expressions, which are obtained after applying only the gene-layer; and (iii) the observed signals (including their location on the slide and the corresponding genes) after applying the layers explained in the following paragraphs. The estimates from a provided dataset are determined by a self-explanatory web site which is linked from the <italic>SIMAGE </italic>web site.</p><p><italic>SIMAGE </italic>was written in Pascal and compiled by FreePascal version 1.0.10 [<xref ref-type="bibr" rid="B6">6</xref>]. Estimates for parameters, based on real data, are provided by a script developed in <italic>R </italic>[<xref ref-type="bibr" rid="B7">7</xref>]. The software requires an Apache web-server and is integrated with a PHP web-interface.</p></sec><sec><title>The general model</title><p>Figure <xref ref-type="fig" rid="F1">1</xref> shows a schematic representation of the model used in this study. Throughout this manuscript, and in the software package, the base-2 logarithm is used, unless stated otherwise. In this model the (log) expression signals are composed of the following components: (i) gene expression, (ii) a raw background gradient signal, (iii) a channel effect, (iv) a spot pin effect, (v) a nonlinear effect, (vi) a quantization and saturation effect, and (vii) random error due to unknown and/or unmodeled factors. The model is explained in more detail in the following text.</p></sec><sec><title>Dimensions and notation</title><p>A DNA-microarray slide consists of a number of spots arranged in a two-dimensional matrix, which, in turn is divided into <italic>n</italic><sub><italic>row </italic></sub>&#x000d7; <italic>n</italic><sub><italic>col </italic></sub>square (sub)grids (see supplementary Fig. S1). Each grid contains <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-7-205-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGUbGBdaqhaaWcbaGaem4CamNaemiCaaNaem4Ba8MaemiDaqhabaGaeGOmaidaaaaa@34E0@</mml:annotation></mml:semantics></mml:math></inline-formula> spots (<italic>n</italic><sub><italic>spot </italic></sub>in both the horizontal and vertical direction), amounting to a total number of <italic>n</italic><sub><italic>row </italic></sub>&#x000d7; <italic>n</italic><sub><italic>col </italic></sub>&#x000d7; <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-7-205-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGUbGBdaqhaaWcbaGaem4CamNaemiCaaNaem4Ba8MaemiDaqhabaGaeGOmaidaaaaa@34E0@</mml:annotation></mml:semantics></mml:math></inline-formula> spots per slide. In total, <italic>n</italic><sub><italic>slide </italic></sub>slides are simulated with each spot providing a measure of the green (Cy3) and the red (Cy5) signal. The simulated log expression at spot (<italic>i, j</italic>) of array <italic>l </italic>and channel <italic>k </italic>is denoted by <italic>y</italic><sub><italic>ijkl</italic></sub>.</p></sec><sec><title>Gene expressions</title><p>To distinguish between non-regulated and regulated genes, the log ratio is considered. Assuming absence of other systematic deviations, the log ratio of the Cy3 and C5 channel signals log(Cy3/Cy5) = log(Cy3) - log(Cy5), is zero for non-regulated genes (with deviances only due to randomness), positive for up-regulated genes, and negative for down-regulated genes. The part of <italic>y</italic><sub><italic>jikl </italic></sub>that is affected in this gene expression layer will be called <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-7-205-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG5bqEdaqhaaWcbaGaemyAaKMaemOAaOMaem4AaSMaemiBaWgabaGaeiOkaOcaaaaa@34A8@</mml:annotation></mml:semantics></mml:math></inline-formula>. This <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-7-205-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG5bqEdaqhaaWcbaGaemyAaKMaemOAaOMaem4AaSMaemiBaWgabaGaeiOkaOcaaaaa@34A8@</mml:annotation></mml:semantics></mml:math></inline-formula> will be the same on all spots where the same gene <italic>g </italic>is spotted (see also formula 3), hence we can use the notation <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-7-205-i3" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>g</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG5bqEdaqhaaWcbaGaem4zaCgabaGaeiOkaOcaaaaa@3087@</mml:annotation></mml:semantics></mml:math></inline-formula>. We split <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-7-205-i3" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>g</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG5bqEdaqhaaWcbaGaem4zaCgabaGaeiOkaOcaaaaa@3087@</mml:annotation></mml:semantics></mml:math></inline-formula> into two parts: <italic>G</italic><sub><italic>g</italic>;<italic>k</italic></sub>, which is concerned with the 'true' expression of gene <italic>g </italic>on channel <italic>k </italic>before any other layer is applied, and <italic>D</italic><sub><italic>g</italic>;<italic>k</italic></sub>, which is a (possible) deviation due to up- or down-regulation of gene <italic>g</italic>. The modeling of <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1471-2105-7-205-i3" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>g</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG5bqEdaqhaaWcbaGaem4zaCgabaGaeiOkaOcaaaaa@3087@</mml:annotation></mml:semantics></mml:math></inline-formula> is done via <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1471-2105-7-205-i4" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>;</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG5bqEdaqhaaWcbaGaem4zaCMaei4oaSJaem4AaSgabaGaeiOkaOcaaaaa@32E4@</mml:annotation></mml:semantics></mml:math></inline-formula> = <italic>G</italic><sub><italic>g</italic>;<italic>k </italic></sub>+ <italic>D</italic><sub><italic>g</italic>;<italic>k</italic></sub>. To start with <italic>G</italic><sub><italic>g</italic>;<italic>k</italic></sub>, we assume that this latent (i.e. unobservable) variable is distributed as <italic>G</italic><sub><italic>g</italic>;<italic>k </italic></sub>~ N(<italic>&#x003bc;</italic>,<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" name="1471-2105-7-205-i5" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaem4raCeabaGaeGOmaidaaaaa@30AC@</mml:annotation></mml:semantics></mml:math></inline-formula>). Here, <italic>&#x003bc; </italic>is the average expression value, and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" name="1471-2105-7-205-i5" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaem4raCeabaGaeGOmaidaaaaa@30AC@</mml:annotation></mml:semantics></mml:math></inline-formula> can be interpreted as the variation in gene expression. Hence, the expressions of non-differentially expressed genes are distributed symmetrically around <italic>&#x003bc;</italic>, according to a normal distribution. For a comment on the normality assumption of <italic>G</italic><sub><italic>g</italic>;<italic>k</italic></sub>, see the end of this paragraph. In most DNA-microarray data <italic>G</italic><sub><italic>g</italic>;1 </sub>and <italic>G</italic><sub><italic>g</italic>;2 </sub>are not statistically independent [<xref ref-type="bibr" rid="B8">8</xref>], which can be observed by considering a plot of Cy3 versus Cy5 signals. Therefore the covariance cov(<italic>G</italic><sub><italic>g</italic>;1</sub>,<italic>G</italic><sub><italic>g</italic>;2</sub>) = <italic>&#x003c1;</italic><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" name="1471-2105-7-205-i5" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaem4raCeabaGaeGOmaidaaaaa@30AC@</mml:annotation></mml:semantics></mml:math></inline-formula> is introduced, where <italic>&#x003c1; </italic>is the correlation coefficient between the signals from the two channels.</p><p>For each gene we model the probability of being up-, down- and non-regulated <italic>&#x003c0;</italic><sub>+</sub>, <italic>&#x003c0;</italic><sub>-</sub>, and <italic>&#x003c0;</italic><sub>0</sub>= 1 - <italic>&#x003c0;</italic><sub>+ </sub>- <italic>&#x003c0;</italic><sub>-</sub>, respectively. For up-regulated genes the log ratio is increased by 2<italic>&#x003bc;</italic><sub><italic>D </italic></sub>and for down-regulated genes the log ratio is decreased by 2<italic>&#x003bc;</italic><sub><italic>D</italic></sub>. The effect of regulation is modeled via <italic>D</italic><sub><italic>g</italic>;<italic>k</italic></sub>:</p><p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" name="1471-2105-7-205-i6" overflow="scroll">
                  <mml:semantics definitionURL="" encoding="">
                     <mml:mrow>
                        <mml:mrow>
                           <mml:mo>(</mml:mo>
                           <mml:mrow>
                              <mml:mtable>
                                 <mml:mtr>
                                    <mml:mtd>
                                       <mml:mrow>
                                          <mml:msub>
                                             <mml:mi>D</mml:mi>
                                             <mml:mrow>
                                                <mml:mi>g</mml:mi>
                                                <mml:mo>;</mml:mo>
                                                <mml:mn>1</mml:mn>
                                             </mml:mrow>
                                          </mml:msub>
                                       </mml:mrow>
                                    </mml:mtd>
                                 </mml:mtr>
                                 <mml:mtr>
                                    <mml:mtd>
                                       <mml:mrow>
                                          <mml:msub>
                                             <mml:mi>D</mml:mi>
                                             <mml:mrow>
                                                <mml:mi>g</mml:mi>
                                                <mml:mo>;</mml:mo>
                                                <mml:mn>2</mml:mn>
                                             </mml:mrow>
                                          </mml:msub>
                                       </mml:mrow>
                                    </mml:mtd>
                                 </mml:mtr>
                              </mml:mtable>
                           </mml:mrow>
                           <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mrow>
                           <mml:mo>(</mml:mo>
                           <mml:mrow>
                              <mml:mtable>
                                 <mml:mtr>
                                    <mml:mtd>
                                       <mml:mrow>
                                          <mml:msub>
                                             <mml:mi>k</mml:mi>
                                             <mml:mn>1</mml:mn>
                                          </mml:msub>
                                       </mml:mrow>
                                    </mml:mtd>
                                 </mml:mtr>
                                 <mml:mtr>
                                    <mml:mtd>
                                       <mml:mrow>
                                          <mml:msub>
                                             <mml:mi>k</mml:mi>
                                             <mml:mn>2</mml:mn>
                                          </mml:msub>
                                       </mml:mrow>
                                    </mml:mtd>
                                 </mml:mtr>
                              </mml:mtable>
                           </mml:mrow>
                           <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:msub>
                           <mml:mi>&#x003bc;</mml:mi>
                           <mml:mi>D</mml:mi>
                        </mml:msub>
                        <mml:mtext>,&#x000a0;where&#x000a0;</mml:mtext>
                        <mml:mrow>
                           <mml:mo>(</mml:mo>
                           <mml:mrow>
                              <mml:msub>
                                 <mml:mi>k</mml:mi>
                                 <mml:mn>1</mml:mn>
                              </mml:msub>
                              <mml:mo>,</mml:mo>
                              <mml:msub>
                                 <mml:mi>k</mml:mi>
                                 <mml:mn>2</mml:mn>
                              </mml:msub>
                           </mml:mrow>
                           <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mrow>
                           <mml:mo>{</mml:mo>
                           <mml:mrow>
                              <mml:mtable columnalign="left">
                                 <mml:mtr columnalign="left">
                                    <mml:mtd columnalign="left">
                                       <mml:mrow>
                                          <mml:mrow>
                                             <mml:mo>(</mml:mo>
                                             <mml:mrow>
                                                <mml:mo>&#x02212;</mml:mo>
                                                <mml:mn>1</mml:mn>
                                                <mml:mo>,</mml:mo>
                                                <mml:mn>1</mml:mn>
                                             </mml:mrow>
                                             <mml:mo>)</mml:mo>
                                          </mml:mrow>
                                       </mml:mrow>
                                    </mml:mtd>
                                    <mml:mtd columnalign="left">
                                       <mml:mrow>
                                          <mml:mtext>if&#x000a0;gene&#x000a0;</mml:mtext>
                                          <mml:mi>g</mml:mi>
                                          <mml:mtext>&#x000a0;is&#x000a0;downregulated;</mml:mtext>
                                       </mml:mrow>
                                    </mml:mtd>
                                 </mml:mtr>
                                 <mml:mtr columnalign="left">
                                    <mml:mtd columnalign="left">
                                       <mml:mrow>
                                          <mml:mrow>
                                             <mml:mo>(</mml:mo>
                                             <mml:mrow>
                                                <mml:mtext>0,0</mml:mtext>
                                             </mml:mrow>
                                             <mml:mo>)</mml:mo>
                                          </mml:mrow>
                                       </mml:mrow>
                                    </mml:mtd>
                                    <mml:mtd columnalign="left">
                                       <mml:mrow>
                                          <mml:mtext>if&#x000a0;gene&#x000a0;</mml:mtext>
                                          <mml:mi>g</mml:mi>
                                          <mml:mtext>&#x000a0;is&#x000a0;nonregulated;</mml:mtext>
                                       </mml:mrow>
                                    </mml:mtd>
                                 </mml:mtr>
                                 <mml:mtr columnalign="left">
                                    <mml:mtd columnalign="left">
                                       <mml:mrow>
                                          <mml:mrow>
                                             <mml:mo>(</mml:mo>
                                             <mml:mrow>
                                                <mml:mtext>1,</mml:mtext>
                                                <mml:mo>&#x02212;</mml:mo>
                                                <mml:mtext>1</mml:mtext>
                                             </mml:mrow>
                                             <mml:mo>)</mml:mo>
                                          </mml:mrow>
                                       </mml:mrow>
                                    </mml:mtd>
                                    <mml:mtd columnalign="left">
                                       <mml:mrow>
                                          <mml:mtext>if&#x000a0;gene&#x000a0;</mml:mtext>
                                          <mml:mi>g</mml:mi>
                                          <mml:mtext>&#x000a0;is&#x000a0;upregulated</mml:mtext>
                                          <mml:mtext>.</mml:mtext>
                                       </mml:mrow>
                                    </mml:mtd>
                                 </mml:mtr>
                              </mml:mtable>
                           </mml:mrow>
                        </mml:mrow>
                        <mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext>
                        <mml:mrow>
                           <mml:mo>(</mml:mo>
                           <mml:mn>1</mml:mn>
                           <mml:mo>)</mml:mo>
                        </mml:mrow>
                     </mml:mrow>
                     <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqadaqaauaabeqaceaaaeaacqWGebardaWgaaWcbaGaem4zaCMaei4oaSJaeGymaedabeaaaOqaaiabdseaenaaBaaaleaacqWGNbWzcqGG7aWocqaIYaGmaeqaaaaaaOGaayjkaiaawMcaaiabg2da9maabmaabaqbaeqabiqaaaqaaiabdUgaRnaaBaaaleaacqaIXaqmaeqaaaGcbaGaem4AaS2aaSbaaSqaaiabikdaYaqabaaaaaGccaGLOaGaayzkaaacciGae8hVd02aaSbaaSqaaiabdseaebqabaGccqqGSaalcqqGGaaicqqG3bWDcqqGObaAcqqGLbqzcqqGYbGCcqqGLbqzcqqGGaaidaqadaqaaiabdUgaRnaaBaaaleaacqaIXaqmaeqaaOGaeiilaWIaem4AaS2aaSbaaSqaaiabikdaYaqabaaakiaawIcacaGLPaaacqGH9aqpdaGabaqaauaabaqadiaaaeaadaqadaqaaiabgkHiTiabigdaXiabcYcaSiabigdaXaGaayjkaiaawMcaaaqaaiabbMgaPjabbAgaMjabbccaGiabbEgaNjabbwgaLjabb6gaUjabbwgaLjabbccaGiabdEgaNjabbccaGiabbMgaPjabbohaZjabbccaGiabbsgaKjabb+gaVjabbEha3jabb6gaUjabbkhaYjabbwgaLjabbEgaNjabbwha1jabbYgaSjabbggaHjabbsha0jabbwgaLjabbsgaKjabbUda7aqaamaabmaabaGaeeimaaJaeeilaWIaeeimaadacaGLOaGaayzkaaaabaGaeeyAaKMaeeOzayMaeeiiaaIaee4zaCMaeeyzauMaeeOBa4MaeeyzauMaeeiiaaIaem4zaCMaeeiiaaIaeeyAaKMaee4CamNaeeiiaaIaeeOBa4Maee4Ba8MaeeOBa4MaeeOCaiNaeeyzauMaee4zaCMaeeyDauNaeeiBaWMaeeyyaeMaeeiDaqNaeeyzauMaeeizaqMaee4oaSdabaWaaeWaaeaacqqGXaqmcqqGSaalcqGHsislcqqGXaqmaiaawIcacaGLPaaaaeaacqqGPbqAcqqGMbGzcqqGGaaicqqGNbWzcqqGLbqzcqqGUbGBcqqGLbqzcqqGGaaicqWGNbWzcqqGGaaicqqGPbqAcqqGZbWCcqqGGaaicqqG1bqDcqqGWbaCcqqGYbGCcqqGLbqzcqqGNbWzcqqG1bqDcqqGSbaBcqqGHbqycqqG0baDcqqGLbqzcqqGKbazcqqGUaGlaaaacaGL7baacaWLjaGaaCzcamaabmaabaGaeGymaedacaGLOaGaayzkaaaaaa@C919@</mml:annotation>
                  </mml:semantics>
               </mml:math></inline-formula></p><p>Although <italic>&#x003bc;</italic><sub><italic>D </italic></sub>is a fixed number, because of the sum <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" name="1471-2105-7-205-i4" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>;</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG5bqEdaqhaaWcbaGaem4zaCMaei4oaSJaem4AaSgabaGaeiOkaOcaaaaa@32E4@</mml:annotation></mml:semantics></mml:math></inline-formula> = <italic>G</italic><sub><italic>g</italic>;<italic>k </italic></sub>+ <italic>D</italic><sub><italic>g</italic>;<italic>k </italic></sub>that is 'measured' this layer behaves as if regulated genes get a random sized shift up or down. Note that <italic>G</italic><sub><italic>g</italic>;<italic>k</italic></sub>, as well as almost all other stochastic variables are modeled in <italic>SIMAGE </italic>as outcomes of normal distributions. Although this brings about some oversimplification, we consider this not really an issue or, in the words of Wit and McClure (2004) [<xref ref-type="bibr" rid="B8">8</xref>], 'the misspecification made by using a normal approximation is typically negligible'. In addition, the superposition of the various normally distributed layers does not imply that the generated expressions levels themselves are normally distributed. Furthermore, modeling of <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" name="1471-2105-7-205-i3" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>g</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG5bqEdaqhaaWcbaGaem4zaCgabaGaeiOkaOcaaaaa@3087@</mml:annotation></mml:semantics></mml:math></inline-formula> as a combination of three (normal) densities (non-, up- and down-regulated genes) enables estimating the model parameters (see "gene expressions" below). A more extensive modeling of the gene expressions, although biologically somewhat more correct, will result in a significantly more complex estimation of parameters compared to the parameters described in this study.</p></sec><sec><title>Replication variation</title><p>Spotting (spot pin effects), hybridization (non-uniform distribution of the labeled probe over the slide surface), and quantization (due to slide scanner properties) introduce variation in <italic>y</italic><sub><italic>ijkl </italic></sub>in addition to the 'natural biological variation'. This natural variation is modeled as follows. When a simulated gene <italic>g </italic>is spotted on spot <italic>ijkl</italic>, random errors <italic>&#x003b5;</italic><sub><italic>ij</italic>1<italic>l </italic></sub>and <italic>&#x003b5;</italic><sub><italic>ij</italic>2<italic>l </italic></sub>are drawn from <italic>N</italic>(0,<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" name="1471-2105-7-205-i7" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>&#x003b5;</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGae8xTdugabaGaeGOmaidaaaaa@3137@</mml:annotation></mml:semantics></mml:math></inline-formula>) and are added to the two replicated measurements <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" name="1471-2105-7-205-i8" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn><mml:mi>l</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG5bqEdaqhaaWcbaGaemyAaKMaemOAaOMaeGymaeJaemiBaWgabaGaeiOkaOcaaaaa@3439@</mml:annotation></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" name="1471-2105-7-205-i9" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn><mml:mi>l</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG5bqEdaqhaaWcbaGaemyAaKMaemOAaOMaeGOmaiJaemiBaWgabaGaeiOkaOcaaaaa@343B@</mml:annotation></mml:semantics></mml:math></inline-formula>. Each gene will be replicated <italic>n</italic><sub><italic>rep </italic></sub>times.</p></sec><sec><title>Background surface variation</title><p>The signal distribution over the surface of the DNA-microarray glass-slide is affected by various factors, e.g. slide surface chemistry and hybridization effects, leading to an irregular distribution of the labeled probe on the slide [<xref ref-type="bibr" rid="B8">8</xref>-<xref ref-type="bibr" rid="B10">10</xref>]. The most simplistic way to model such gradient signals is by using a tilted plane, such that the signals on one side of the slide are higher than on the other. A more sophisticated method is that of Balagurunathan and coworkers (2002) [<xref ref-type="bibr" rid="B24">24</xref>] where a quadratic function is implemented. Such a function, however, is limited in the sense that it has only one local extreme (and some extremes located on the slide edges).</p><p>We use a method that allows for a number of local extremes to exist. A number <italic>n</italic><sub><italic>bg </italic></sub>of bivariate normal densities with random parameter settings identifying the location and size on the slide are computed and subsequently multiplied by a random amplitude <italic>I </italic>(between &#x000b1;1). Each density is computed by:</p><p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" name="1471-2105-7-205-i10" overflow="scroll">
                  <mml:semantics definitionURL="" encoding="">
                     <mml:mrow>
                        <mml:msub>
                           <mml:mi>f</mml:mi>
                           <mml:mi>m</mml:mi>
                        </mml:msub>
                        <mml:mrow>
                           <mml:mo>(</mml:mo>
                           <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>j</mml:mi>
                           </mml:mrow>
                           <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mfrac>
                           <mml:mrow>
                              <mml:msub>
                                 <mml:mi>I</mml:mi>
                                 <mml:mi>m</mml:mi>
                              </mml:msub>
                           </mml:mrow>
                           <mml:mrow>
                              <mml:mn>2</mml:mn>
                              <mml:mi>&#x003c0;</mml:mi>
                              <mml:msubsup>
                                 <mml:mi>&#x003c3;</mml:mi>
                                 <mml:mrow>
                                    <mml:mi>b</mml:mi>
                                    <mml:mi>g</mml:mi>
                                    <mml:mi>x</mml:mi>
                                 </mml:mrow>
                                 <mml:mn>2</mml:mn>
                              </mml:msubsup>
                              <mml:msubsup>
                                 <mml:mi>&#x003c3;</mml:mi>
                                 <mml:mrow>
                                    <mml:mi>b</mml:mi>
                                    <mml:mi>g</mml:mi>
                                    <mml:mi>y</mml:mi>
                                 </mml:mrow>
                                 <mml:mn>2</mml:mn>
                              </mml:msubsup>
                              <mml:msqrt>
                                 <mml:mrow>
                                    <mml:mn>1</mml:mn>
                                    <mml:mo>&#x02212;</mml:mo>
                                    <mml:msubsup>
                                       <mml:mi>&#x003c1;</mml:mi>
                                       <mml:mrow>
                                          <mml:mi>b</mml:mi>
                                          <mml:mi>g</mml:mi>
                                       </mml:mrow>
                                       <mml:mn>2</mml:mn>
                                    </mml:msubsup>
                                 </mml:mrow>
                              </mml:msqrt>
                           </mml:mrow>
                        </mml:mfrac>
                        <mml:msup>
                           <mml:mi>e</mml:mi>
                           <mml:mrow>
                              <mml:mrow>
                                 <mml:mo>[</mml:mo>
                                 <mml:mrow>
                                    <mml:mo>&#x02212;</mml:mo>
                                    <mml:mfrac>
                                       <mml:mn>1</mml:mn>
                                       <mml:mrow>
                                          <mml:mn>2</mml:mn>
                                          <mml:mrow>
                                             <mml:mo>(</mml:mo>
                                             <mml:mrow>
                                                <mml:mn>1</mml:mn>
                                                <mml:mo>&#x02212;</mml:mo>
                                                <mml:msubsup>
                                                   <mml:mi>&#x003c1;</mml:mi>
                                                   <mml:mrow>
                                                      <mml:mi>b</mml:mi>
                                                      <mml:mi>g</mml:mi>
                                                   </mml:mrow>
                                                   <mml:mn>2</mml:mn>
                                                </mml:msubsup>
                                             </mml:mrow>
                                             <mml:mo>)</mml:mo>
                                          </mml:mrow>
                                       </mml:mrow>
                                    </mml:mfrac>
                                    <mml:mrow>
                                       <mml:mo>(</mml:mo>
                                       <mml:mrow>
                                          <mml:mfrac>
                                             <mml:mrow>
                                                <mml:msup>
                                                   <mml:mrow>
                                                      <mml:mrow>
                                                         <mml:mo>(</mml:mo>
                                                         <mml:mrow>
                                                            <mml:mi>i</mml:mi>
                                                            <mml:mo>&#x02212;</mml:mo>
                                                            <mml:msub>
                                                               <mml:mi>&#x003bc;</mml:mi>
                                                               <mml:mrow>
                                                                  <mml:mi>b</mml:mi>
                                                                  <mml:mi>g</mml:mi>
                                                                  <mml:mo>,</mml:mo>
                                                                  <mml:mi>x</mml:mi>
                                                               </mml:mrow>
                                                            </mml:msub>
                                                         </mml:mrow>
                                                         <mml:mo>)</mml:mo>
                                                      </mml:mrow>
                                                   </mml:mrow>
                                                   <mml:mn>2</mml:mn>
                                                </mml:msup>
                                             </mml:mrow>
                                             <mml:mrow>
                                                <mml:msubsup>
                                                   <mml:mi>&#x003c3;</mml:mi>
                                                   <mml:mrow>
                                                      <mml:mi>b</mml:mi>
                                                      <mml:mi>g</mml:mi>
                                                      <mml:mo>,</mml:mo>
                                                      <mml:mi>x</mml:mi>
                                                   </mml:mrow>
                                                   <mml:mn>2</mml:mn>
                                                </mml:msubsup>
                                             </mml:mrow>
                                          </mml:mfrac>
                                          <mml:mo>&#x02212;</mml:mo>
                                          <mml:mn>2</mml:mn>
                                          <mml:mi>&#x003c1;</mml:mi>
                                          <mml:mfrac>
                                             <mml:mrow>
                                                <mml:mrow>
                                                   <mml:mo>(</mml:mo>
                                                   <mml:mrow>
                                                      <mml:mi>i</mml:mi>
                                                      <mml:mo>&#x02212;</mml:mo>
                                                      <mml:msub>
                                                         <mml:mi>&#x003bc;</mml:mi>
                                                         <mml:mrow>
                                                            <mml:mi>b</mml:mi>
                                                            <mml:mi>g</mml:mi>
                                                            <mml:mo>,</mml:mo>
                                                            <mml:mi>x</mml:mi>
                                                         </mml:mrow>
                                                      </mml:msub>
                                                   </mml:mrow>
                                                   <mml:mo>)</mml:mo>
                                                </mml:mrow>
                                                <mml:mrow>
                                                   <mml:mo>(</mml:mo>
                                                   <mml:mrow>
                                                      <mml:mi>j</mml:mi>
                                                      <mml:mo>&#x02212;</mml:mo>
                                                      <mml:msub>
                                                         <mml:mi>&#x003bc;</mml:mi>
                                                         <mml:mrow>
                                                            <mml:mi>b</mml:mi>
                                                            <mml:mi>g</mml:mi>
                                                            <mml:mo>,</mml:mo>
                                                            <mml:mi>y</mml:mi>
                                                         </mml:mrow>
                                                      </mml:msub>
                                                   </mml:mrow>
                                                   <mml:mo>)</mml:mo>
                                                </mml:mrow>
                                             </mml:mrow>
                                             <mml:mrow>
                                                <mml:msub>
                                                   <mml:mi>&#x003c3;</mml:mi>
                                                   <mml:mrow>
                                                      <mml:mi>b</mml:mi>
                                                      <mml:mi>g</mml:mi>
                                                      <mml:mo>,</mml:mo>
                                                      <mml:mi>x</mml:mi>
                                                   </mml:mrow>
                                                </mml:msub>
                                                <mml:msub>
                                                   <mml:mi>&#x003c3;</mml:mi>
                                                   <mml:mrow>
                                                      <mml:mi>b</mml:mi>
                                                      <mml:mi>g</mml:mi>
                                                      <mml:mo>,</mml:mo>
                                                      <mml:mi>y</mml:mi>
                                                   </mml:mrow>
                                                </mml:msub>
                                             </mml:mrow>
                                          </mml:mfrac>
                                          <mml:mo>+</mml:mo>
                                          <mml:mfrac>
                                             <mml:mrow>
                                                <mml:msup>
                                                   <mml:mrow>
                                                      <mml:mrow>
                                                         <mml:mo>(</mml:mo>
                                                         <mml:mrow>
                                                            <mml:mi>j</mml:mi>
                                                            <mml:mo>&#x02212;</mml:mo>
                                                            <mml:msub>
                                                               <mml:mi>&#x003bc;</mml:mi>
                                                               <mml:mrow>
                                                                  <mml:mi>b</mml:mi>
                                                                  <mml:mi>g</mml:mi>
                                                                  <mml:mo>,</mml:mo>
                                                                  <mml:mi>y</mml:mi>
                                                               </mml:mrow>
                                                            </mml:msub>
                                                         </mml:mrow>
                                                         <mml:mo>)</mml:mo>
                                                      </mml:mrow>
                                                   </mml:mrow>
                                                   <mml:mn>2</mml:mn>
                                                </mml:msup>
                                             </mml:mrow>
                                             <mml:mrow>
                                                <mml:msubsup>
                                                   <mml:mi>&#x003c3;</mml:mi>
                                                   <mml:mrow>
                                                      <mml:mi>b</mml:mi>
                                                      <mml:mi>g</mml:mi>
                                                      <mml:mo>,</mml:mo>
                                                      <mml:mi>y</mml:mi>
                                                   </mml:mrow>
                                                   <mml:mn>2</mml:mn>
                                                </mml:msubsup>
                                             </mml:mrow>
                                          </mml:mfrac>
                                       </mml:mrow>
                                       <mml:mo>)</mml:mo>
                                    </mml:mrow>
                                 </mml:mrow>
                                 <mml:mo>]</mml:mo>
                              </mml:mrow>
                           </mml:mrow>
                        </mml:msup>
                        <mml:mo>,</mml:mo>
                        <mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext>
                        <mml:mrow>
                           <mml:mo>(</mml:mo>
                           <mml:mn>2</mml:mn>
                           <mml:mo>)</mml:mo>
                        </mml:mrow>
                     </mml:mrow>
                     <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGMbGzdaWgaaWcbaGaemyBa0gabeaakmaabmaabaGaemyAaKMaeiilaWIaemOAaOgacaGLOaGaayzkaaGaeyypa0ZaaSaaaeaacqWGjbqsdaWgaaWcbaGaemyBa0gabeaaaOqaaiabikdaYGGaciab=b8aWjab=n8aZnaaDaaaleaacqWGIbGycqWGNbWzcqWG4baEaeaacqaIYaGmaaGccqWFdpWCdaqhaaWcbaGaemOyaiMaem4zaCMaemyEaKhabaGaeGOmaidaaOWaaOaaaeaacqaIXaqmcqGHsislcqWFbpGCdaqhaaWcbaGaemOyaiMaem4zaCgabaGaeGOmaidaaaqabaaaaOGaemyzau2aaWbaaSqabeaadaWadaqaaiabgkHiTmaalaaabaGaeGymaedabaGaeGOmaiZaaeWaaeaacqaIXaqmcqGHsislcqWFbpGCdaqhaaadbaGaemOyaiMaem4zaCgabaGaeGOmaidaaaWccaGLOaGaayzkaaaaamaabmaabaWaaSaaaeaadaqadaqaaiabdMgaPjabgkHiTiab=X7aTnaaBaaameaacqWGIbGycqWGNbWzcqGGSaalcqWG4baEaeqaaaWccaGLOaGaayzkaaWaaWbaaWqabeaacqaIYaGmaaaaleaacqWFdpWCdaqhaaadbaGaemOyaiMaem4zaCMaeiilaWIaemiEaGhabaGaeGOmaidaaaaaliabgkHiTiabikdaYiab=f8aYnaalaaabaWaaeWaaeaacqWGPbqAcqGHsislcqWF8oqBdaWgaaadbaGaemOyaiMaem4zaCMaeiilaWIaemiEaGhabeaaaSGaayjkaiaawMcaamaabmaabaGaemOAaOMaeyOeI0Iae8hVd02aaSbaaWqaaiabdkgaIjabdEgaNjabcYcaSiabdMha5bqabaaaliaawIcacaGLPaaaaeaacqWFdpWCdaWgaaadbaGaemOyaiMaem4zaCMaeiilaWIaemiEaGhabeaaliab=n8aZnaaBaaameaacqWGIbGycqWGNbWzcqGGSaalcqWG5bqEaeqaaaaaliabgUcaRmaalaaabaWaaeWaaeaacqWGQbGAcqGHsislcqWF8oqBdaWgaaadbaGaemOyaiMaem4zaCMaeiilaWIaemyEaKhabeaaaSGaayjkaiaawMcaamaaCaaameqabaGaeGOmaidaaaWcbaGae83Wdm3aa0baaWqaaiabdkgaIjabdEgaNjabcYcaSiabdMha5bqaaiabikdaYaaaaaaaliaawIcacaGLPaaaaiaawUfacaGLDbaaaaGccqGGSaalcaWLjaGaaCzcamaabmaabaGaeGOmaidacaGLOaGaayzkaaaaaa@B5C9@</mml:annotation>
                  </mml:semantics>
               </mml:math></inline-formula></p><p>where the parameters are provided by the user. These densities are summed, together with a linear gradient with a random tilt lower than <italic>s</italic>, to constitute the background surface signals (see Fig. <xref ref-type="fig" rid="F1">1B</xref>, top panel; see also the supplementary document). An additive modeling of the background effect is chosen over a multiplicative model. As to the reasons why, see the supplementary document.</p></sec><sec><title>Channel deviations, gene-dye interactions and spot pin deviation</title><p>The rationale behind the modeling of these three layers is the same: for each of the layer values a deviation, drawn from a normal distribution, is added to (a subset of) the Cy3 / Cy5 signals.</p><p>In some actual DNA-microarray experiments, the average Cy3 signal is significantly different from the average Cy5 signal obtained for a spot; reasons are: gene-to-gene variation in dye incorporating efficiencies, global differences in Cy3 and Cy5 abundance in the DNA preparations, and bleaching of the dyes (Cy5 is inactivated faster than Cy3). This effect is incorporated in the model by a random deviation <italic>C</italic><sub>1 </sub>for <italic>N</italic>(0,<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" name="1471-2105-7-205-i11" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaem4yamMaemiAaGMaemyyaeMaemOBa4MaemOBa4MaemyzauMaemiBaWgabaGaeGOmaidaaaaa@3906@</mml:annotation></mml:semantics></mml:math></inline-formula>) to all Cy3-measurements and another random deviation <italic>C</italic><sub>2 </sub>from this distribution to all Cy5-measurements.</p><p>Differential incorporation of dyes in DNA occurs due to (i) the preference of reverse transcriptase for the physically smaller Cy3 label in case of direct labeling and (ii) differential hybridization because of the physically larger Cy5 label. The effects differ between genes as a consequence of DNA size and the distribution of the labeled nucleotides in the DNA molecule [<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B12">12</xref>]. Gene-dye interactions are embedded in the model similarly to the channel effect: for all measurements belonging to gene <italic>g </italic>and dye <italic>d </italic>a random deviation <italic>X</italic><sub><italic>gk </italic></sub>from <italic>N</italic>(0,<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" name="1471-2105-7-205-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaem4zaCMaey41aqRaemizaqgabaGaeGOmaidaaaaa@3454@</mml:annotation></mml:semantics></mml:math></inline-formula>) is added to the signal.</p><p>Spot pins show systematic deviations in the amount of probe delivered to the glass surface. The signals measured of targets spotted with one spot pin might differ significantly from those spotted with another spot pin. The <italic>n</italic><sub><italic>pin </italic></sub>drawings <italic>S</italic><sub><italic>pin</italic>(<italic>ij</italic>) </sub>from <italic>N</italic>(0,<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" name="1471-2105-7-205-i13" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaemiCaaNaemyAaKMaemOBa4gabaGaeGOmaidaaaaa@33BE@</mml:annotation></mml:semantics></mml:math></inline-formula>) are used to model these effects. Spot pin effects are equal for both channels.</p></sec><sec><title>Non-linearity</title><p>(<italic>M</italic>, <italic>A</italic>) plots [<xref ref-type="bibr" rid="B13">13</xref>] from experimentally obtained DNA-microarray data often look somewhat curved (e.g. "banana shaped") and / or tilted, generally with higher deviations for lower <italic>A </italic>values (see "quantization and saturation" below). The <italic>SIMAGE </italic>model allows for non-linearity using a transformation <italic>f</italic><sub><italic>nl </italic></sub>based on two parameters: <italic>&#x003b1;</italic><sub>1</sub>, specifying the maximum amount of curvature to be allowed, and <italic>&#x003b1;</italic><sub>2</sub>, which specifies the maximum amount of linear tilt. Although the transformation is relatively simple, the resulting data mimics experimental data closely enough with respect to non-linearity. The exact definition of the modeling of this layer and some examples of the resulting curvature is presented in the supplementary document.</p></sec><sec><title>Fishtails</title><p>A common artifact of DNA-microarray data is that genes with a lower expression tend to be noisier. This is apparent in the 'fishtail' appearance of (<italic>M</italic>, <italic>A</italic>) graphs. The main reason for this artifact is mainly that spots with a lower signal are quantified with larger errors than spots with higher signals [<xref ref-type="bibr" rid="B14">14</xref>]. Another reason could be the 'over-transformation' of data due to the log-transformation, and that a less influential power transformation would be more appropriate to obtain normally distributed gene expressions. It would, however, be extremely complicated to use another transformation, since the property of logarithms that it turns multiplicative effects into additive effects is used throughout the complete <italic>SIMAGE </italic>model. We have to content ourselves with this approximation.</p><p>The fishtailing behavior is incorporated in <italic>SIMAGE </italic>by a parameter <italic>&#x003b4; </italic>that inflates the log ratio for spots with an average expression <italic>A</italic><sub><italic>ijl </italic></sub>below <italic>&#x003bc; </italic>by a factor <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" name="1471-2105-7-205-i14" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>&#x003b4;</mml:mi><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>M</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqadaqaaiabigdaXiabgUcaRGGaciab=r7aKjab=n8aZnaaDaaaleaacqWGnbqtaeaacqGHsislcqaIYaGmaaGcdaqadaqaaiabdgeabnaaBaaaleaacqWGPbqAcqWGQbGAcqWGSbaBaeqaaOGaeyOeI0Iae8hVd0gacaGLOaGaayzkaaWaaWbaaSqabeaacqaIYaGmaaaakiaawIcacaGLPaaaaaa@4154@</mml:annotation></mml:semantics></mml:math></inline-formula>. A higher value of <italic>&#x003b4; </italic>will result in a stronger effect and <italic>&#x003b4; </italic>= 0 indicates no fishtail effect. The parameter <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23" name="1471-2105-7-205-i15" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>M</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaemyta0eabaGaeGOmaidaaaaa@30B8@</mml:annotation></mml:semantics></mml:math></inline-formula> will be introduced below ("gene expressions"). Our model mimics biological replicates by randomizing the effect of <italic>&#x003b4; </italic>for non-regulated genes. For each slide these genes have a probability of 1/2 of being influenced by fishtailing. In this way, the expressions of non-regulated genes are seldom distributed in such a way that they appear differentially regulated in a simulated experiment with replicated slides.</p></sec><sec><title>Quantization and saturation</title><p>Slide scanning introduces another non-linearity artifact. The scanning device uses 16 bits to describe signal strength, i.e. signals are always between log(2<sup>0</sup>) = 0 and log(2<sup>16</sup>) = 16. Furthermore, some DNA-microarray data scanners tend to over-measure low values, and under-measure high values [<xref ref-type="bibr" rid="B15">15</xref>]. When no over- or under-measurement occurs, the signal transformation <italic>l</italic><sub>0</sub>(<italic>y</italic>) = min(max(0,y),16) on <italic>y </italic>will be used to incorporate the cutoff at log(2<sup>0</sup>) = 0 and log(2<sup>16</sup>) = 16. A maximal over- or under-measurement effect will result in the signal transformation <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M24" name="1471-2105-7-205-i16" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>16</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mstyle scriptlevel="+1"><mml:mfrac><mml:mi>y</mml:mi><mml:mn>4</mml:mn></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGSbaBdaWgaaWcbaGaeGymaedabeaakmaabmaabaGaemyEaKhacaGLOaGaayzkaaGaeyypa0JaeGymaeJaeGOnayJaei4la8YaaeWaaeaacqaIXaqmcqGHRaWkcyGGLbqzcqGG4baEcqGGWbaCdaqadaqaaiabikdaYiabgkHiTmaaleaaleaacqWG5bqEaeaacqaI0aanaaaakiaawIcacaGLPaaaaiaawIcacaGLPaaaaaa@439B@</mml:annotation></mml:semantics></mml:math></inline-formula>. This transformation inflates low signals, deflates high signals, and leaves medium signals unchanged.</p><p>Via a parameter <italic>w </italic>(<italic>w </italic>between 0 and 1) the <italic>SIMAGE </italic>model is instructed on the severity of the bias. The transformation <italic>g</italic><sub><italic>nl </italic></sub>used is a weighted average of <italic>l</italic><sub>0 </sub>and <italic>l</italic><sub>1</sub>, namely <italic>g</italic><sub><italic>nl </italic></sub>= (1 - <italic>w</italic>)<italic>l</italic><sub>0</sub>(<italic>y</italic>) + <italic>wl</italic><sub>1</sub>(<italic>y</italic>). The supplementary document provides a visualization of the effect of different choices of <italic>w</italic>.</p></sec><sec><title>Missing data</title><p>In actual DNA-microarray data measurements may be missing. Reasons are: slide surface imperfections, hybridization effects, no DNA delivered to the glass surface during the spotting process or presence of fibers or dust particles. Our simulation model implements three types of missing data (with signals set to 0): (i) line-segments mimic 'hairs', (ii) 'donuts' comprising multiple spots mimic dirty areas and (iii) missing spots. The implementation of the model allows specifying the number of occurrences of these types of missing data as well as their maximum size and shape.</p></sec><sec><title>The <italic>SIMAGE </italic>model</title><p>In the <italic>SIMAGE </italic>model 29 parameters have to be specified (Table <xref ref-type="table" rid="T2">2</xref>), of which 6 are known constants (e.g. the number of spots in a grid). The model, which results from the components described above, is defined as follows: the simulated log expression at spot (<italic>i, j</italic>) of array <italic>l </italic>and channel <italic>k </italic>is denoted by <italic>y</italic><sub><italic>ijkl </italic></sub>as:</p><p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M25" name="1471-2105-7-205-i18" overflow="scroll">
                  <mml:semantics definitionURL="" encoding="">
                     <mml:mtable columnalign="left">
                        <mml:mtr>
                           <mml:mtd>
                              <mml:msub>
                                 <mml:mi>y</mml:mi>
                                 <mml:mrow>
                                    <mml:mi>i</mml:mi>
                                    <mml:mi>j</mml:mi>
                                    <mml:mi>k</mml:mi>
                                    <mml:mi>l</mml:mi>
                                 </mml:mrow>
                              </mml:msub>
                              <mml:mo>=</mml:mo>
                              <mml:msub>
                                 <mml:mi>g</mml:mi>
                                 <mml:mrow>
                                    <mml:mi>n</mml:mi>
                                    <mml:mi>l</mml:mi>
                                 </mml:mrow>
                              </mml:msub>
                              <mml:mrow>
                                 <mml:mo>(</mml:mo>
                                 <mml:mrow>
                                    <mml:msub>
                                       <mml:mi>t</mml:mi>
                                       <mml:mi>&#x003b4;</mml:mi>
                                    </mml:msub>
                                    <mml:mrow>
                                       <mml:mo>(</mml:mo>
                                       <mml:mrow>
                                          <mml:msub>
                                             <mml:mi>f</mml:mi>
                                             <mml:mrow>
                                                <mml:mi>n</mml:mi>
                                                <mml:mi>l</mml:mi>
                                             </mml:mrow>
                                          </mml:msub>
                                          <mml:mrow>
                                             <mml:mo>(</mml:mo>
                                             <mml:mrow>
                                                <mml:mi>b</mml:mi>
                                                <mml:msub>
                                                   <mml:mi>g</mml:mi>
                                                   <mml:mrow>
                                                      <mml:mi>i</mml:mi>
                                                      <mml:mi>j</mml:mi>
                                                      <mml:mi>l</mml:mi>
                                                   </mml:mrow>
                                                </mml:msub>
                                                <mml:mo>+</mml:mo>
                                                <mml:msub>
                                                   <mml:mi>z</mml:mi>
                                                   <mml:mrow>
                                                      <mml:mi>i</mml:mi>
                                                      <mml:mi>j</mml:mi>
                                                      <mml:mi>k</mml:mi>
                                                      <mml:mi>l</mml:mi>
                                                   </mml:mrow>
                                                </mml:msub>
                                             </mml:mrow>
                                             <mml:mo>)</mml:mo>
                                          </mml:mrow>
                                       </mml:mrow>
                                       <mml:mo>)</mml:mo>
                                    </mml:mrow>
                                 </mml:mrow>
                                 <mml:mo>)</mml:mo>
                              </mml:mrow>
                              <mml:mo>&#x022c5;</mml:mo>
                              <mml:msub>
                                 <mml:mi>m</mml:mi>
                                 <mml:mrow>
                                    <mml:mi>i</mml:mi>
                                    <mml:mi>j</mml:mi>
                                    <mml:mi>l</mml:mi>
                                 </mml:mrow>
                              </mml:msub>
                              <mml:mo>,</mml:mo>
                              <mml:mtext>&#x000a0;with</mml:mtext>
                           </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                           <mml:mtd>
                              <mml:msub>
                                 <mml:mi>z</mml:mi>
                                 <mml:mrow>
                                    <mml:mi>i</mml:mi>
                                    <mml:mi>j</mml:mi>
                                    <mml:mi>k</mml:mi>
                                    <mml:mi>l</mml:mi>
                                 </mml:mrow>
                              </mml:msub>
                              <mml:mo>=</mml:mo>
                              <mml:msub>
                                 <mml:mi>G</mml:mi>
                                 <mml:mrow>
                                    <mml:mi>g</mml:mi>
                                    <mml:mi>e</mml:mi>
                                    <mml:mi>n</mml:mi>
                                    <mml:mi>e</mml:mi>
                                    <mml:mrow>
                                       <mml:mo>(</mml:mo>
                                       <mml:mrow>
                                          <mml:mi>i</mml:mi>
                                          <mml:mi>j</mml:mi>
                                          <mml:mi>l</mml:mi>
                                       </mml:mrow>
                                       <mml:mo>)</mml:mo>
                                    </mml:mrow>
                                    <mml:mo>;</mml:mo>
                                    <mml:mi>k</mml:mi>
                                 </mml:mrow>
                              </mml:msub>
                              <mml:mo>+</mml:mo>
                              <mml:msub>
                                 <mml:mi>D</mml:mi>
                                 <mml:mrow>
                                    <mml:mi>g</mml:mi>
                                    <mml:mi>e</mml:mi>
                                    <mml:mi>n</mml:mi>
                                    <mml:mi>e</mml:mi>
                                    <mml:mrow>
                                       <mml:mo>(</mml:mo>
                                       <mml:mrow>
                                          <mml:mi>i</mml:mi>
                                          <mml:mi>j</mml:mi>
                                          <mml:mi>l</mml:mi>
                                       </mml:mrow>
                                       <mml:mo>)</mml:mo>
                                    </mml:mrow>
                                    <mml:mo>;</mml:mo>
                                    <mml:mi>k</mml:mi>
                                 </mml:mrow>
                              </mml:msub>
                              <mml:mo>+</mml:mo>
                              <mml:msub>
                                 <mml:mi>C</mml:mi>
                                 <mml:mi>k</mml:mi>
                              </mml:msub>
                              <mml:mo>+</mml:mo>
                              <mml:msub>
                                 <mml:mi>S</mml:mi>
                                 <mml:mrow>
                                    <mml:mi>p</mml:mi>
                                    <mml:mi>i</mml:mi>
                                    <mml:mi>n</mml:mi>
                                    <mml:mrow>
                                       <mml:mo>(</mml:mo>
                                       <mml:mrow>
                                          <mml:mi>i</mml:mi>
                                          <mml:mi>j</mml:mi>
                                       </mml:mrow>
                                       <mml:mo>)</mml:mo>
                                    </mml:mrow>
                                 </mml:mrow>
                              </mml:msub>
                              <mml:mo>+</mml:mo>
                              <mml:msub>
                                 <mml:mi>X</mml:mi>
                                 <mml:mrow>
                                    <mml:mi>g</mml:mi>
                                    <mml:mi>e</mml:mi>
                                    <mml:mi>n</mml:mi>
                                    <mml:mi>e</mml:mi>
                                    <mml:mrow>
                                       <mml:mo>(</mml:mo>
                                       <mml:mrow>
                                          <mml:mi>i</mml:mi>
                                          <mml:mi>j</mml:mi>
                                          <mml:mi>l</mml:mi>
                                       </mml:mrow>
                                       <mml:mo>)</mml:mo>
                                    </mml:mrow>
                                    <mml:mo>;</mml:mo>
                                    <mml:mi>k</mml:mi>
                                 </mml:mrow>
                              </mml:msub>
                              <mml:mo>+</mml:mo>
                              <mml:msub>
                                 <mml:mi>&#x003b5;</mml:mi>
                                 <mml:mrow>
                                    <mml:mi>i</mml:mi>
                                    <mml:mi>j</mml:mi>
                                    <mml:mi>k</mml:mi>
                                    <mml:mi>l</mml:mi>
                                 </mml:mrow>
                              </mml:msub>
                              <mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext>
                              <mml:mrow>
                                 <mml:mo>(</mml:mo>
                                 <mml:mn>3</mml:mn>
                                 <mml:mo>)</mml:mo>
                              </mml:mrow>
                           </mml:mtd>
                        </mml:mtr>
                     </mml:mtable>
                     <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakqaabeqaaiabdMha5naaBaaaleaacqWGPbqAcqWGQbGAcqWGRbWAcqWGSbaBaeqaaOGaeyypa0Jaem4zaC2aaSbaaSqaaiabd6gaUjabdYgaSbqabaGcdaqadaqaaiabdsha0naaBaaaleaaiiGacqWF0oazaeqaaOWaaeWaaeaacqWGMbGzdaWgaaWcbaGaemOBa4MaemiBaWgabeaakmaabmaabaGaemOyaiMaem4zaC2aaSbaaSqaaiabdMgaPjabdQgaQjabdYgaSbqabaGccqGHRaWkcqWG6bGEdaWgaaWcbaGaemyAaKMaemOAaOMaem4AaSMaemiBaWgabeaaaOGaayjkaiaawMcaaaGaayjkaiaawMcaaaGaayjkaiaawMcaaiabgwSixlabd2gaTnaaBaaaleaacqWGPbqAcqWGQbGAcqWGSbaBaeqaaOGaeiilaWIaeeiiaaIaee4DaCNaeeyAaKMaeeiDaqNaeeiAaGgabaGaemOEaO3aaSbaaSqaaiabdMgaPjabdQgaQjabdUgaRjabdYgaSbqabaGccqGH9aqpcqWGhbWrdaWgaaWcbaGaem4zaCMaemyzauMaemOBa4Maemyzau2aaeWaaeaacqWGPbqAcqWGQbGAcqWGSbaBaiaawIcacaGLPaaacqGG7aWocqWGRbWAaeqaaOGaey4kaSIaemiraq0aaSbaaSqaaiabdEgaNjabdwgaLjabd6gaUjabdwgaLnaabmaabaGaemyAaKMaemOAaOMaemiBaWgacaGLOaGaayzkaaGaei4oaSJaem4AaSgabeaakiabgUcaRiabdoeadnaaBaaaleaacqWGRbWAaeqaaOGaey4kaSIaem4uam1aaSbaaSqaaiabdchaWjabdMgaPjabd6gaUnaabmaabaGaemyAaKMaemOAaOgacaGLOaGaayzkaaaabeaakiabgUcaRiabdIfaynaaBaaaleaacqWGNbWzcqWGLbqzcqWGUbGBcqWGLbqzdaqadaqaaiabdMgaPjabdQgaQjabdYgaSbGaayjkaiaawMcaaiabcUda7iabdUgaRbqabaGccqGHRaWkcqWF1oqzdaWgaaWcbaGaemyAaKMaemOAaOMaem4AaSMaemiBaWgabeaakiaaxMaacaWLjaWaaeWaaeaacqaIZaWmaiaawIcacaGLPaaaaaaa@B3F0@</mml:annotation>
                  </mml:semantics>
               </mml:math></inline-formula></p><p>where</p><p><italic>gene</italic>(<italic>ijl</italic>) the gene spotted at location (<italic>i</italic>, <italic>j</italic>,<italic>l</italic>) (see "dimensions and notation" above);</p><p><italic>pin</italic>(<italic>ij</italic>) the spot pin used to spot location (<italic>i</italic>, <italic>j</italic>);</p><p><italic>g</italic><sub><italic>nl </italic></sub>a transformation due to quantization and saturation;</p><p><italic>t</italic><sub><italic>&#x003b4; </italic></sub>a transformation due to 'fishtailing';</p><p><italic>f</italic><sub><italic>nl </italic></sub>a transformation due to non-linearity in measurements;</p><p><italic>m</italic><sub><italic>ijkl </italic></sub>equals 0 if the spot at location (<italic>i</italic>, <italic>j</italic>,<italic>l</italic>) is 'missing', and 1 otherwise (see "missing data" above);</p><p><italic>bg</italic><sub><italic>ijl </italic></sub>the background gradient level (see "background variation" above);</p><p><italic>G</italic><sub><italic>g</italic>;<italic>k </italic></sub>the expression level of gene <italic>g </italic>in channel <italic>k</italic>;</p><p><italic>D</italic><sub><italic>g</italic>;<italic>k </italic></sub>the change in expression due to up-/down-regulation;</p><p><italic>C</italic><sub><italic>k </italic></sub>the channel effect;</p><p><italic>S</italic><sub><italic>pin</italic>(<italic>ij</italic>) </sub>the spot pin effect;</p><p><italic>X</italic><sub><italic>gene</italic>(<italic>ijl</italic>);<italic>k </italic></sub>the gene &#x000d7; dye interaction;</p><p><italic>&#x003b5;</italic><sub><italic>ijkl </italic></sub>the replication error.</p></sec><sec><title>Datasets used and estimation of the parameters</title><p>In order to estimate the parameters for a number of slides hybridized at the Department of Molecular Genetics (MolGen), DNA-microarray data from 47 <italic>Lactococcus lactis </italic>IL1403 slides from MolGen [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B16">16</xref>-<xref ref-type="bibr" rid="B18">18</xref>] were used (supplementary Table T1). These datasets specify, for each spot: (i) the annotated gene names, (ii) the raw expression values for both channels, and (iii) an estimated background signal. Parameters were determined from the net intensity values of the slides (i.e. corrected for background signals).</p><p>Besides MolGen slides, several slides from the public domain were analyzed. Datasets GDS69, GDS100, and GDS273 were obtained from the Gene Expression Omnibus from NCBI [<xref ref-type="bibr" rid="B19">19</xref>]. The dataset MEXP-225 was obtained from EBI's ArrayExpress [<xref ref-type="bibr" rid="B20">20</xref>]. In the supplementary web site [<xref ref-type="bibr" rid="B5">5</xref>], the exact slides used for the parameter estimations are listed.</p><p>The <italic>SIMAGE </italic>web site provides a tool for the estimation steps described in the following sections. In order to obtain robust estimates for the slides, some slides yielding obviously outlying estimates, i.e. when <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M26" name="1471-2105-7-205-i11" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaem4yamMaemiAaGMaemyyaeMaemOBa4MaemOBa4MaemyzauMaemiBaWgabaGaeGOmaidaaaaa@3906@</mml:annotation></mml:semantics></mml:math></inline-formula> was larger than <italic>&#x003bc;</italic>, were discarded. Only those experiments were used for which at least 3 slides with acceptable estimates were obtained. The estimates of the MolGen "experiment" were determined by the median of the "experiment" slides, while the MolGen "validation" estimates were determined by the median of the estimates of the validation slide data [<xref ref-type="bibr" rid="B3">3</xref>] (supplementary Table T1). For each of the 5 experiments, DNA-microarray data obtained from the same slide batch were used to estimate the experiment-specific parameters (see Results). This was done to minimize slide batch-specific bias in parameter estimation. The median, rather than the mean, of the estimates for each parameter is used as input in <italic>SIMAGE </italic>simulation interface because of the nonsymmetrical distribution of the estimates.</p></sec><sec><title>Background gradient and densities</title><p>Spot background signals for the MolGen slides were determined as described [<xref ref-type="bibr" rid="B3">3</xref>]. Estimates for the number of background densities to be estimated, as well as their average standard deviations, were obtained by visually inspecting a number of experimentally obtained background densities. Furthermore, estimates for the average horizontal and vertical linear tilt were obtained by fitting a regression plane through the background signal distribution.</p></sec><sec><title>Non-linearity, quantization and saturation</title><p>A direct way to estimate the scanning device bias parameter <italic>w </italic>is not feasible since this parameter is confounded within the other variables in the <italic>SIMAGE </italic>model. One could assume absence of scanning device bias (<italic>w </italic>= 0). We used an alternative method to estimate this parameter (for more details see the supplementary document). The estimation of the non-linearity parameters <italic>&#x003b1;</italic><sub>1 </sub>and <italic>&#x003b1;</italic><sub>2 </sub>is done as follows: in the (<italic>M</italic>, <italic>A</italic>) plot for background-corrected data (hence, the net signals), a Lowess curve [<xref ref-type="bibr" rid="B21">21</xref>] is fitted. Then a second degree polynomial is fitted to this Lowess curve, and the parameters <italic>&#x003b1;</italic><sub>1 </sub>and <italic>&#x003b1;</italic><sub>2 </sub>are directly derived from the parameters of the polynomial (see the supplementary document for details).</p></sec><sec><title>Spot pin effects, channel effects, fishtails and replication variation</title><p>After subtracting the estimates for the background signals and the non-linearity effects from <italic>y</italic><sub><italic>ijkl </italic></sub>(the original signal) we obtain <italic>z</italic><sub><italic>ijkl</italic></sub>, where <italic>z</italic><sub><italic>ijkl </italic></sub>= <italic>G</italic><sub><italic>gene</italic>(<italic>ijl</italic>);<italic>k </italic></sub>+ <italic>D</italic><sub><italic>gene</italic>(<italic>ijl</italic>);<italic>k </italic></sub>+ <italic>C</italic><sub><italic>k </italic></sub>+ <italic>S</italic><sub><italic>pin</italic>(<italic>ij</italic>) </sub>+ <italic>X</italic><sub><italic>gene</italic>(<italic>ijl</italic>);<italic>k </italic></sub>+ <italic>&#x003b5;</italic><sub><italic>ijkl</italic></sub>. The estimation of the gene layer factors <italic>G </italic>and <italic>D </italic>is discussed in the following paragraph. For all other factors, the estimation of their parameters is a matter of calculating a variance components model.</p><p>The gene-dye interaction is strongest when direct labeling of RNA is applied. An analysis by ANOVA of indirectly-labeled RNA used in self hybridization slides [<xref ref-type="bibr" rid="B3">3</xref>] and dye-swapped replicated slides (results not shown) performed at MolGen showed that the gene-dye interaction effects did not differ significantly. Note that the factor <italic>X</italic><sub><italic>gene</italic>(<italic>ijl</italic>);<italic>k </italic></sub>can only reliably be estimated in case dye-swaps are performed with the same RNA.</p><p>The fishtail parameter <italic>&#x003b4; </italic>was estimated by fitting a quadratic curve through the data points (<italic>A</italic><sub><italic>ijl</italic></sub>,<italic>|M</italic><sub><italic>ijl</italic></sub><italic>|</italic>) with <italic>A</italic><sub><italic>ijl </italic></sub>&#x0003c;<italic>&#x003bc; </italic>(for details see the supplementary document).</p></sec><sec><title>Gene expressions</title><p>After correcting <italic>z</italic><sub><italic>ijkl </italic></sub>for all factors except <italic>G </italic>and <italic>D</italic>, the parameters for <italic>G </italic>and <italic>D </italic>are estimated as follows: define <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M27" name="1471-2105-7-205-i19" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGzbqwgaacamaaBaaaleaacqWGNbWzcqGGSaalcqWGRbWAaeqaaaaa@31B8@</mml:annotation></mml:semantics></mml:math></inline-formula> as the average value of the <italic>n</italic><sub><italic>rep</italic></sub>replications <italic>Y</italic><sub><italic>ijkl </italic></sub>with <italic>gene</italic>(<italic>ijl</italic>) = <italic>g </italic>: <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M28" name="1471-2105-7-205-i20" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>l</mml:mi><mml:mo>|</mml:mo><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGzbqwgaacamaaBaaaleaacqWGNbWzcqGG7aWocqWGRbWAaeqaaOGaeyypa0ZaaSaaaeaacqaIXaqmaeaacqWGUbGBdaWgaaWcbaGaemOCaiNaemyzauMaemiCaahabeaaaaGcdaaeqbqaaiabdMfaznaaBaaaleaacqWGPbqAcqWGQbGAcqWGSbaBaeqaaaqaaiabdMgaPjabdQgaQjabdYgaSjabcYha8jabdEgaNjabdwgaLjabd6gaUjabdwgaLnaabmaabaGaemyAaKMaemOAaOMaemiBaWgacaGLOaGaayzkaaGaeyypa0Jaem4zaCgabeqdcqGHris5aaaa@543C@</mml:annotation></mml:semantics></mml:math></inline-formula>. Given the distributional assumptions outlined in "gene expressions" above, standard statistical theory provides that both the average log ratio (<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M29" name="1471-2105-7-205-i21" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGnbqtgaacamaaBaaaleaacqWGNbWzaeqaaOGaeyypa0JafmywaKLbaGaadaWgaaWcbaGaem4zaCMaei4oaSJaeGymaedabeaakiabgkHiTiqbdMfazzaaiaWaaSbaaSqaaiabdEgaNjabcUda7iabikdaYaqabaaaaa@3AE0@</mml:annotation></mml:semantics></mml:math></inline-formula>) of the gene and the average intensity (<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M30" name="1471-2105-7-205-i22" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle scriptlevel="+1"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGbbqqgaacamaaBaaaleaacqWGNbWzaeqaaOGaeyypa0ZaaSqaaSqaaiabigdaXaqaaiabikdaYaaakmaabmaabaGafmywaKLbaGaadaWgaaWcbaGaem4zaCMaei4oaSJaeGymaedabeaakiabgUcaRiqbdMfazzaaiaWaaSbaaSqaaiabdEgaNjabcUda7iabikdaYaqabaaakiaawIcacaGLPaaaaaa@3E58@</mml:annotation></mml:semantics></mml:math></inline-formula>) of the gene are independently normally distributed, with variances <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M31" name="1471-2105-7-205-i15" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>M</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaemyta0eabaGaeGOmaidaaaaa@30B8@</mml:annotation></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M32" name="1471-2105-7-205-i23" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaemyqaeeabaGaeGOmaidaaaaa@30A0@</mml:annotation></mml:semantics></mml:math></inline-formula>, respectively. The distribution <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M33" name="1471-2105-7-205-i24" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGbbqqgaacamaaBaaaleaacqWGNbWzaeqaaaaa@2F49@</mml:annotation></mml:semantics></mml:math></inline-formula> does not depend on whether gene <italic>g </italic>is up-, down- or non-regulated, and the parameters <italic>&#x003bc; </italic>and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M34" name="1471-2105-7-205-i23" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaemyqaeeabaGaeGOmaidaaaaa@30A0@</mml:annotation></mml:semantics></mml:math></inline-formula> involved, as well as the variance <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M35" name="1471-2105-7-205-i7" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>&#x003b5;</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGae8xTdugabaGaeGOmaidaaaaa@3137@</mml:annotation></mml:semantics></mml:math></inline-formula>, are estimated in a straightforward way. The mean of the distribution of <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M36" name="1471-2105-7-205-i25" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGnbqtgaacamaaBaaaleaacqWGNbWzaeqaaaaa@2F61@</mml:annotation></mml:semantics></mml:math></inline-formula> depends on whether the gene is up-, down- or non-regulated. The parameters <italic>&#x003c0;</italic><sub>-</sub>, <italic>&#x003c0;</italic><sub>+</sub>, <italic>&#x003bc;</italic><sub><italic>D </italic></sub>and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M37" name="1471-2105-7-205-i15" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>M</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaemyta0eabaGaeGOmaidaaaaa@30B8@</mml:annotation></mml:semantics></mml:math></inline-formula> are estimated using the <italic>EM</italic>-algorithm [<xref ref-type="bibr" rid="B22">22</xref>] (Figure <xref ref-type="fig" rid="F2">2</xref>) with some restrictions (see the supplementary document). Note that for self-self hybridizations <italic>&#x003c0;</italic><sub>- </sub>= <italic>&#x003c0;</italic><sub>+ </sub>= 0 and the estimation of <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M38" name="1471-2105-7-205-i15" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>M</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaemyta0eabaGaeGOmaidaaaaa@30B8@</mml:annotation></mml:semantics></mml:math></inline-formula> is straightforward (it is the 'ordinary' variance of the <italic>M</italic>-values). Furthermore, fishtailing does not affect the spots with above-average intensities (<italic>A</italic><sub><italic>ijl </italic></sub>&#x0003e; <italic>&#x003bc;</italic>), nor the <italic>A</italic>-values. For all spots with average intensities higher than the overall average intensity, the <italic>A</italic>- and <italic>M</italic>-values are used to estimate parameters.</p><p>The estimates for <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M39" name="1471-2105-7-205-i5" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaem4raCeabaGaeGOmaidaaaaa@30AC@</mml:annotation></mml:semantics></mml:math></inline-formula> and <italic>&#x003c1; </italic>(see "gene expressions" above), required for the <italic>SIMAGE </italic>model, are calculated from the estimates for <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M40" name="1471-2105-7-205-i23" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaemyqaeeabaGaeGOmaidaaaaa@30A0@</mml:annotation></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M41" name="1471-2105-7-205-i15" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>M</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaemyta0eabaGaeGOmaidaaaaa@30B8@</mml:annotation></mml:semantics></mml:math></inline-formula>.</p></sec></sec><sec><title>Results</title><p>To illustrate the use of <italic>SIMAGE </italic>in drawing meaningful conclusions about the design and analysis of DNA microarray experiments we show a number of examples based on DNA microarray data generated within the MolGen department. <italic>SIMAGE </italic>is used as follows: (i) define parameters based on real DNA microarray data that are laboratory / experiment-specific, (ii) these parameters are roughly estimated by our estimation procedure, (iii) using these estimated parameters DNA microarray data is simulated mimicking real DNA microarray data as close as possible.</p><sec><title>The parameter estimation</title><p>On the basis of a number of experiments that were performed at the MolGen department, the "MolGen experiment" parameters, 100 slides were simulated using <italic>SIMAGE</italic>. For each simulated slide, the model parameters were estimated using the estimation web-interface. Deviations of the mean and median of the estimated parameters from the original parameters are shown in Table <xref ref-type="table" rid="T3">3</xref> and Figure <xref ref-type="fig" rid="F3">3</xref>.</p><p>The estimation of <italic>&#x003bc;</italic>, <italic>&#x003c3;</italic><sub>channel </sub>and <italic>&#x003c3;</italic><sub><italic>&#x003b5; </italic></sub>are good (Table <xref ref-type="table" rid="T3">3</xref>). Parameter <italic>&#x003c3;</italic><sub>pin </sub>is somewhat systematically overestimated (Fig. <xref ref-type="fig" rid="F3">3</xref>). The parameters <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M42" name="1471-2105-7-205-i5" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaem4raCeabaGaeGOmaidaaaaa@30AC@</mml:annotation></mml:semantics></mml:math></inline-formula> and <italic>&#x003c1; </italic>tend to be systematically mildly underestimated. This is likely because of the nonsymmetric estimation of <italic>&#x003c1; </italic>(the true value of <italic>&#x003c1; </italic>is usually close to 1), which influences <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M43" name="1471-2105-7-205-i5" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaem4raCeabaGaeGOmaidaaaaa@30AC@</mml:annotation></mml:semantics></mml:math></inline-formula> which is calculated from the estimate of <italic>&#x003c1;</italic>. The performance of the estimations of <italic>&#x003b4;</italic>, <italic>&#x003b1;</italic><sub>1</sub>, <italic>&#x003b1;</italic><sub>2 </sub>and <italic>w </italic>depends highly on the actual values of these parameters. For low values of these parameters, they tend to be overestimated, while they are for high values underestimated. However, the estimation is rather good. As an indication, based on 100 slides with <italic>&#x003b4;</italic>, <italic>&#x003b1;</italic><sub>1</sub>, <italic>&#x003b1;</italic><sub>2</sub>, and <italic>w </italic>all zero, the maxima of the 100 estimates for these parameters are 0.01, 0.004, 0.08, and 0.16 respectively.</p><p>The quality of the estimations of <italic>&#x003bc;</italic><sub>-</sub>, <italic>&#x003bc;</italic><sub>+</sub>, <italic>&#x003c0;</italic><sub>-</sub>, <italic>&#x003c0;</italic><sub>+ </sub>is highly experiment-dependent. Table <xref ref-type="table" rid="T3">3</xref> and Figure <xref ref-type="fig" rid="F3">3</xref> show results for the choice of <italic>&#x003bc;</italic><sub>- </sub>= -1, <italic>&#x003bc;</italic><sub>+ </sub>= 1, <italic>&#x003c0;</italic><sub>- </sub>= <italic>&#x003c0;</italic><sub>+ </sub>= 10%, hence when the proportions of regulated genes and their average shifts in log ratio are considerable. The theory of Dempster and coworkers (1977) [<xref ref-type="bibr" rid="B22">22</xref>] indicates that the estimates of <italic>&#x003bc;</italic><sub>-</sub>, <italic>&#x003bc;</italic><sub>+</sub>, <italic>&#x003c0;</italic><sub>-</sub>, <italic>&#x003c0;</italic><sub>+ </sub>are unbiased: provided the correctness of our underlying statistical assumptions, no other estimators perform better. This is in concordance with the deviations listed in Table <xref ref-type="table" rid="T3">3</xref>. In some cases where the true values of <italic>&#x003bc;</italic><sub>-</sub>, <italic>&#x003bc;</italic><sub>+</sub>, <italic>&#x003c0;</italic><sub>-</sub>, and <italic>&#x003c0;</italic><sub>+ </sub>are small their estimates are rather poor (Fig. <xref ref-type="fig" rid="F3">3</xref>). The user of the web-interface is suggested to 'tweak' these gene-expression estimates somewhat, if necessary.</p></sec><sec><title>Within-laboratory experiment-dependency of estimated parameters</title><p>In order to investigate whether parameter estimates for different experiments from the same laboratory are significantly different, two profiles were generated: (i) "real" experiments [<xref ref-type="bibr" rid="B16">16</xref>-<xref ref-type="bibr" rid="B18">18</xref>] and (ii) validation experiments [<xref ref-type="bibr" rid="B3">3</xref>]. A Bonferonni-corrected Mann-Whitney test (<italic>&#x003b1; </italic>= 5%) showed that only parameters <italic>&#x003bc; </italic>and <italic>&#x003c1; </italic>differ between the DNA-microarray data simulated using both profiles (supplementary Fig. S2, upper panel). Within the various "real" experiments, only the parameters describing regulation (<italic>&#x003bc;</italic><sub>+</sub>, <italic>&#x003c0;</italic><sub>+,</sub><italic>&#x003bc;</italic><sub>-</sub>, and <italic>&#x003c0;</italic><sub>-</sub>) differ significantly (supplementary Fig. S2, lower panel). Parameters concerned with technical aspects of the DNA microarray spotter and scanner are, as expected, not significantly different, since the same equipment in one laboratory was used. Future studies on datasets obtained in other laboratories may implicate other parameters than those described above.</p></sec><sec><title>Between-laboratory experiment-dependency of estimated parameters</title><p>The model parameters were estimated from five different datasets, obtained by different laboratories and querying the mRNA levels of different organisms. The CVs of the model parameters obtained for individual datasets are, in general, lower than those obtained for the combined experiments (Fig. <xref ref-type="fig" rid="F4">4</xref>). Parameters which differ strongly between the datasets (combined CV values are higher than the CVs of the individual experiment) are: average expression (<italic>&#x003bc;</italic>), tail behavior (<italic>&#x003b4;</italic>), gene variance (<italic>&#x003c3;</italic><sup>2</sup><sub>gene</sub>), and the general error (<italic>&#x003c3;</italic><sub><italic>&#x003b5;</italic></sub>). For a few datasets the estimation of the parameters is quite "noisy", e.g. the CV for the non-linearity of scanner parameter (<italic>w</italic>) of the GDS69 dataset (Fig. <xref ref-type="fig" rid="F4">4</xref>). ANOVA shows that the estimated parameters, with the exception of the spot pin variation <italic>&#x003c3;</italic><sub>pin </sub>and the covariance <italic>&#x003c1;</italic>, are strongly experiment-dependent (Fig. <xref ref-type="fig" rid="F4">4</xref>). In particular the gene variance (<italic>&#x003c3;</italic><sup>2</sup><sub>gene</sub>) is strongly influenced by the experiment (<italic>p</italic>-value of 10<sup>-21</sup>; Fig. <xref ref-type="fig" rid="F4">4</xref>).</p></sec><sec><title>Graphical features of the simulated data</title><p>To ensure that the simulated data contains similar properties as experimentally obtained data, several aspects of the simulated slides were inspected. In supplementary Figure S3 three simulated and three "real" slides are visualized via an (<italic>M</italic>, <italic>A</italic>)-plot and by grid-based box plots. Several properties of the experimental slides are clearly present in a similar way in the simulated slides. Figure <xref ref-type="fig" rid="F5">5</xref> shows a graphical representation of the net and background spot signals of a simulated slide.</p></sec><sec><title>The modeled differentially expressed genes</title><p><italic>SIMAGE </italic>allows modeling differentially expressed genes as is demonstrated in an <italic>in silico </italic>simulated experiment (Fig. <xref ref-type="fig" rid="F6">6</xref>). In almost all cases the <italic>p</italic>-values and ratios of the 66 modeled differentially expressed genes (the blue diamonds in Fig. <xref ref-type="fig" rid="F6">6</xref>) are significantly lower than those of the non-modeled genes (the red squares in Fig. <xref ref-type="fig" rid="F6">6</xref>). Relatively few of the known differentially expressed genes had signals that were close to the background signals: these genes get <italic>p</italic>-values close to 1. The inset in Figure <xref ref-type="fig" rid="F6">6</xref> clearly demonstrates the signal dependency of the <italic>p</italic>-values: differentially expressed genes with higher expression levels are assigned lower <italic>p</italic>-values. This is in concordance with the p-value distributions in "real" DNA-microarray datasets.</p></sec></sec><sec><title>Discussion</title><p>As various factors, of both technical and biological nature, affect the quality of DNA-microarray data, it is essential to use a proper experiment design and sophisticated statistics and bioinformatics methods to deal with these variables. Since the factors involved, as well as their relative influence on data quality, vary between DNA-microarray laboratories and differ even between experiments executed in the same laboratory, the question as to which design and analysis method is best, cannot be answered in general terms. <italic>SIMAGE</italic>, a model and web-implementation to simulate gene expressions, requires the specification of up to 29 parameters. It allows simulating data that resemble experimental DNA-microarray data. To determine the relative contribution of the various parameters in DNA-microarray data is a knowledgeable task. A second web-implementation is provided to easily provide rough but reasonable estimates of most of these parameters from experimental DNA-microarray datasets. There is an important educational aspect about the simulation of DNA-microarray data, which is clearly illustrated in Figure <xref ref-type="fig" rid="F1">1B</xref>: it provides clear insights in the contribution of each background layer of the model to the measured signal.</p><p>Almost all parameters in the model are strongly dependent on the experiment performed (Fig. <xref ref-type="fig" rid="F4">4</xref> and supplementary Fig. S2). This holds both for biological parameters in several different experiments from the same laboratory and for technical and biological parameters in experiments from different laboratories. The experiment-dependency of the <italic>&#x003bc; </italic>estimations (Fig. <xref ref-type="fig" rid="F4">4</xref>) is obvious from the fact that the average signals in the prokaryote datasets are higher than those in the eukaryote datasets. This is due to the fact that prokaryotes generally express a larger complement of their genes. The experiment-dependency of the gene variance (<italic>&#x003c3;</italic><sup>2</sup><sub>gene</sub>) might also be attributed to differences in gene expression in the different organisms interrogated in the DNA-microarray experiments discussed above. The latter is also clearly reflected by the high significance of the <italic>&#x003c3;</italic><sup>2</sup><sub>gene </sub>parameter obtained by ANOVA.</p><p>Any method for simulation of DNA microarray data can be questioned and criticized, mainly because there is neither established theory for the relation between expression (observed) and factors involved (some can be observed, others are hidden), nor for the statistical distribution of differential expression given by various causes across genes. Choices about the statistical aspects of the data need to be made when building a simulation model such as <italic>SIMAGE</italic>. Different choices would lead to (slightly) different models with other 'optimal parameter estimation methods'. We have compared the distribution of simulated data (under various circumstances) with that of experimentally obtained data and adapted our model to be able to mimic experimental data as much as possible.</p><p>Creating a <italic>SIMAGE</italic>-like model to simulate data from other than dual-dye DNA microarray platforms might be interesting for future work. Our approach, using layers to model the factors involved, could be universally applied to simulate such data. This is, however, quite a task, since each type of DNA microarray platform has its own specific properties. Affymetrix, for instance, employs single-dye chips. The model of the synthesis of oligonucleotides on the chip surface and the different signals obtained for multiple probes would have to be quite sophisticated. Another interesting approach would be to expand <italic>SIMAGE </italic>to incorporate gene-regulatory interactions or genes involved in documented pathways. The use of simulated gene-regulatory networks would provide a powerful tool to estimate the efficiency of network reconstruction algorithms.</p></sec><sec><title>Conclusion</title><p>A number of models for DNA microarray data simulation have recently been developed (Table <xref ref-type="table" rid="T1">1</xref>). The question how to simulate DNA microarray data in the best way is not easily and straight-forwardly answered. There are many considerations that pose a researcher wanting to simulate DNA microarray data for difficult choices. We have developed <italic>SIMAGE</italic>: software that simulates dual-dye DNA microarray data. The model that we employ, although more advanced than existing models, is still a simplification of reality. To ensure that the simulated DNA microarray data mimics real data as close as possible the model is "fitted" onto "real" DNA microarray data.</p></sec><sec><title>Availability and requirements</title><p><bold>Project name</bold>: <italic>SIMAGE</italic></p><p><bold>Project home page</bold>: <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.biol.rug.nl/websoftware/simage"/></p><p><bold>Operating system(s)</bold>: Runs on any JavaScript enabled web-browser.</p><p><bold>Programming languages</bold>: PHP, Pascal, R, and shell scripting.</p><p><bold>Other requirements</bold>: Additional files and figures are contained in the supplementary web site which is accessible from the above-mentioned web site.</p><p><bold>License</bold>: The web-resource is freely accessible. Details concerning the conditions for using <italic>SIMAGE </italic>are available from the above-mentioned web site.</p></sec><sec><title>Authors' contributions</title><p>SvH and CA conceived the <italic>SIMAGE </italic>concept and methodology. SvH programmed <italic>SIMAGE </italic>including the web-interface and CA programmed the estimator script. CA and SvH drafted the manuscript and generated the figures and tables. RJ, JK and OK critically read and revised the final manuscript. All authors read and approved the final manuscript.</p></sec></body><back><ack><sec><title>Acknowledgements</title><p>We would like to thank Gerard te Meerman, Anne de Jong, and Paul Eilers for useful discussion and suggestions.</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Piper</surname><given-names>MDW</given-names></name><name><surname>ran-Lapujade</surname><given-names>P</given-names></name><name><surname>Bro</surname><given-names>C</given-names></name><name><surname>Regenberg</surname><given-names>B</given-names></name><name><surname>Knudsen</surname><given-names>S</given-names></name><name><surname>Nielsen</surname><given-names>J</given-names></name><name><surname>Pronk</surname><given-names>JT</given-names></name></person-group><article-title>Reproducibility of oligonucleotide microarray transcriptome analyses - An interlaboratory comparison using chemostat cultures of Saccharomyces cerevisiae</article-title><source>J Biol Chem</source><year>2002</year><volume>277</volume><fpage>37001</fpage><lpage>37008</lpage><pub-id pub-id-type="pmid">12121991</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>JJ</given-names></name><name><surname>Delongchamp</surname><given-names>RR</given-names></name><name><surname>Tsai</surname><given-names>CA</given-names></name><name><surname>Hsueh</surname><given-names>HM</given-names></name><name><surname>Sistare</surname><given-names>F</given-names></name><name><surname>Thompson</surname><given-names>KL</given-names></name><name><surname>Desai</surname><given-names>VG</given-names></name><name><surname>Fuscoe</surname><given-names>JG</given-names></name></person-group><article-title>Analysis of variance components in gene expression data</article-title><source>Bioinformatics</source><year>2004</year><volume>20</volume><fpage>1436</fpage><lpage>1446</lpage><pub-id pub-id-type="pmid">14962916</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Van Hijum</surname><given-names>SAFT</given-names></name><name><surname>De Jong</surname><given-names>A</given-names></name><name><surname>Baerends</surname><given-names>RJ</given-names></name><name><surname>Karsens</surname><given-names>HA</given-names></name><name><surname>Kramer</surname><given-names>NE</given-names></name><name><surname>Larsen</surname><given-names>R</given-names></name><name><surname>Den Hengst</surname><given-names>CD</given-names></name><name><surname>Albers</surname><given-names>CJ</given-names></name><name><surname>Kok</surname><given-names>J</given-names></name><name><surname>Kuipers</surname><given-names>OP</given-names></name></person-group><article-title>A generally applicable validation scheme for the assessment of factors involved in reproducibility and quality of DNA-microarray data</article-title><source>BMC Genomics</source><year>2005</year><volume>6</volume><fpage>77</fpage><pub-id pub-id-type="pmid">15907200</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kerr</surname><given-names>MK</given-names></name><name><surname>Martin</surname><given-names>M</given-names></name><name><surname>Churchill</surname><given-names>GA</given-names></name></person-group><article-title>Analysis of variance for gene expression microarray data</article-title><source>J Comput Biol</source><year>2000</year><volume>7</volume><fpage>819</fpage><lpage>837</lpage><pub-id pub-id-type="pmid">11382364</pub-id></citation></ref><ref id="B5"><citation citation-type="other"><article-title>The SIMAGE web-site</article-title><year>2006</year><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.biol.rug.nl/websoftware/simage"/></citation></ref><ref id="B6"><citation citation-type="other"><article-title>The FreePascal homepage</article-title><year>2006</year><ext-link ext-link-type="uri" xlink:href="http://www.freepascal.org"/></citation></ref><ref id="B7"><citation citation-type="other"><article-title>The R project</article-title><year>2006</year><ext-link ext-link-type="uri" xlink:href="http://www.r-project.org"/></citation></ref><ref id="B8"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Wit</surname><given-names>E</given-names></name><name><surname>McClure</surname><given-names>J</given-names></name></person-group><source>Statistics for Microarrays - Design, Analysis and Inference</source><year>2004</year><edition>first</edition><publisher-name>Hobroken NJ, John Wiley &#x00026; Sons</publisher-name></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Efron</surname><given-names>B</given-names></name><name><surname>Tibshirani</surname><given-names>R</given-names></name><name><surname>Storey</surname><given-names>J</given-names></name><name><surname>Tusher</surname><given-names>V</given-names></name></person-group><article-title>Empirical Bayes analysis of a microarray experiment</article-title><source>J Am Stat Assoc</source><year>2001</year><volume>96</volume><fpage>1151</fpage><lpage>1160</lpage></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wolkenhouer</surname><given-names>O</given-names></name><name><surname>Moeller-Levet</surname><given-names>C</given-names></name><name><surname>Sanchez-Cabo</surname><given-names>F</given-names></name></person-group><article-title>The curse of normalization</article-title><source>Comp Func Genomics</source><year>2002</year><volume>3</volume><fpage>375</fpage><lpage>379</lpage></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dombkowski</surname><given-names>AA</given-names></name><name><surname>Thibodeau</surname><given-names>BJ</given-names></name><name><surname>Starcevic</surname><given-names>SL</given-names></name><name><surname>Novak</surname><given-names>RF</given-names></name></person-group><article-title>Gene-specific dye bias in microarray reference designs</article-title><source>FEBS Lett</source><year>2004</year><volume>560</volume><fpage>120</fpage><lpage>124</lpage><pub-id pub-id-type="pmid">14988009</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Martin-Magniette</surname><given-names>ML</given-names></name><name><surname>Aubert</surname><given-names>J</given-names></name><name><surname>Cabannes</surname><given-names>E</given-names></name><name><surname>Daudin</surname><given-names>JJ</given-names></name></person-group><article-title>Evaluation of the gene-specific dye bias in cDNA microarray experiments</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>1995</fpage><lpage>2000</lpage><pub-id pub-id-type="pmid">15691855</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dudoit</surname><given-names>S</given-names></name><name><surname>Yang</surname><given-names>YH</given-names></name><name><surname>Luu</surname><given-names>P</given-names></name><name><surname>Speed</surname><given-names>TP</given-names></name></person-group><article-title>Normalization for cDNA microarray data</article-title><source>Proc SPIE</source><year>2001</year><volume>4266</volume><fpage>141</fpage><lpage>152</lpage></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Widrow</surname><given-names>B</given-names></name><name><surname>Koll&#x000e1;r</surname><given-names>I</given-names></name><name><surname>Liu</surname><given-names>MC</given-names></name></person-group><article-title>Statistical theory of quantization</article-title><source>IEEE Trans Instrum Meas</source><year>1996</year><volume>45</volume><fpage>353</fpage><lpage>361</lpage></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Garc&#x000ed;a de la Nava</surname><given-names>J</given-names></name><name><surname>Van Hijum</surname><given-names>SAFT</given-names></name><name><surname>Trelles</surname><given-names>O</given-names></name></person-group><article-title>Saturation and Quantization Reduction in Microarray Experiments using Two Scans at Different Sensitivities</article-title><source>Stat Appl Gen Mol Biol</source><year>2004</year><volume>3</volume><fpage>Article 11</fpage></citation></ref><ref id="B16"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Larsen</surname><given-names>R</given-names></name></person-group><source>Transcriptional regulation of central amino acid metabolism in Lactococcus lactis</source><year>2005</year><publisher-name>the Netherlands, University of Groningen</publisher-name></citation></ref><ref id="B17"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Kramer</surname><given-names>NE</given-names></name></person-group><source>Nisin-resistance in Gram-positive bacteria</source><year>2005</year><publisher-name>the Netherlands, University of Groningen</publisher-name></citation></ref><ref id="B18"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Den Hengst</surname><given-names>CD</given-names></name><name><surname>Van Hijum</surname><given-names>SAFT</given-names></name><name><surname>Geurts</surname><given-names>JM</given-names></name><name><surname>Nauta</surname><given-names>A</given-names></name><name><surname>Kok</surname><given-names>J</given-names></name><name><surname>Kuipers</surname><given-names>OP</given-names></name></person-group><article-title>The Lactococcus lactis CodY regulon: identification of a conserved cis-regulatory element</article-title><source>J Biol Chem</source><year>2005</year><volume>280</volume><fpage>34332</fpage><lpage>34342</lpage><pub-id pub-id-type="pmid">16040604</pub-id></citation></ref><ref id="B19"><citation citation-type="other"><article-title>The gene expression omnibus (GEO) from NCBI</article-title><year>2006</year><ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/geo"/></citation></ref><ref id="B20"><citation citation-type="other"><article-title>EBI databases - ArrayExpress home</article-title><year>2006</year><ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/arrayexpress"/></citation></ref><ref id="B21"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>YH</given-names></name><name><surname>Dudoit</surname><given-names>S</given-names></name><name><surname>Luu</surname><given-names>P</given-names></name><name><surname>Lin</surname><given-names>DM</given-names></name><name><surname>Peng</surname><given-names>V</given-names></name><name><surname>Ngai</surname><given-names>J</given-names></name><name><surname>Speed</surname><given-names>TP</given-names></name></person-group><article-title>Normalization for cDNA microarray data: a robust composite method addressing single and multiple slide systematic variation</article-title><source>Nucleic Acids Res</source><year>2002</year><volume>30</volume><fpage>e15</fpage><pub-id pub-id-type="pmid">11842121</pub-id></citation></ref><ref id="B22"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dempster</surname><given-names>AP</given-names></name><name><surname>Laird</surname><given-names>NM</given-names></name><name><surname>Rubin</surname><given-names>DB</given-names></name></person-group><article-title>Maximum Likelihood from Incomplete Data Via EM Algorithm</article-title><source>J R Stat Soc Ser B Methodol</source><year>1977</year><volume>39</volume><fpage>1</fpage><lpage>38</lpage></citation></ref><ref id="B23"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Lalush</surname><given-names>DS</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Lin S and Johnson K</surname></name></person-group><article-title>Characterization, modeling, and simulation of mouse microarray data</article-title><source>Methods of Microarray Data Analysis III</source><year>2003</year><edition>first</edition><publisher-name>Boston, USA, Kluwer</publisher-name></citation></ref><ref id="B24"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Balagurunathan</surname><given-names>Y</given-names></name><name><surname>Dougherty</surname><given-names>ER</given-names></name><name><surname>Chen</surname><given-names>YD</given-names></name><name><surname>Bittner</surname><given-names>ML</given-names></name><name><surname>Trent</surname><given-names>JM</given-names></name></person-group><article-title>Simulation of cDNA microarrays via a parameterized random signal model</article-title><source>J Biomed Opt</source><year>2002</year><volume>7</volume><fpage>507</fpage><lpage>523</lpage><pub-id pub-id-type="pmid">12175304</pub-id></citation></ref><ref id="B25"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lonnstedt</surname><given-names>I</given-names></name><name><surname>Speed</surname><given-names>T</given-names></name></person-group><article-title>Replicated microarray data</article-title><source>Stat Sin</source><year>2002</year><volume>12</volume><fpage>31</fpage><lpage>46</lpage></citation></ref><ref id="B26"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wierling</surname><given-names>CK</given-names></name><name><surname>Steinfath</surname><given-names>M</given-names></name><name><surname>Elge</surname><given-names>T</given-names></name><name><surname>Schulze-Kremer</surname><given-names>S</given-names></name><name><surname>Aanstad</surname><given-names>P</given-names></name><name><surname>Clark</surname><given-names>M</given-names></name><name><surname>Lehrach</surname><given-names>H</given-names></name><name><surname>Herwig</surname><given-names>R</given-names></name></person-group><article-title>Simulation of DNA array hybridization experiments and evaluation of critical parameters during subsequent image and data analysis</article-title><source>BMC Bioinformatics</source><year>2002</year><volume>3</volume><fpage>29</fpage><pub-id pub-id-type="pmid">12390683</pub-id></citation></ref><ref id="B27"><citation citation-type="other"><article-title>Gene expression data simulator</article-title><year>2006</year><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.upmc.edu/GE2/index.html"/></citation></ref></ref-list><sec sec-type="display-objects"><title>Figures and Tables</title><fig position="float" id="F1"><label>Figure 1</label><caption><p><bold>Schematic overview of the <italic>SIMAGE </italic>model (A) and a few layers visualized (B and C). </bold>The blue-marked boxes (A) indicate layers that are further visualized (B and C). A simulation of the entire 'non-biological' signal is shown in B and C. Top row, sum of the gradient effects and density effects; second row, spot pin effects; third row: Gaussian noise. The bottom row shows the sum of all the effects pictured in the top three rows. The signals are plotted three-dimensionally (left side view) and two-dimensionally (right side view).</p></caption><graphic xlink:href="1471-2105-7-205-1"/></fig><fig position="float" id="F2"><label>Figure 2</label><caption><p><bold>The gene expression parameters</bold>. These parameters (Table 2) were estimated by using the <italic>EM</italic>-algorithm (see "gene expressions" in the implementation section). The vertical lines constitute a stem-plot of the data. The red, green and blue curves indicate down-, not-, and up-regulated genes, respectively. The black curve is a combination of the three curves and, hence, the distribution of the logratios.</p></caption><graphic xlink:href="1471-2105-7-205-2"/></fig><fig position="float" id="F3"><label>Figure 3</label><caption><p><bold>Distribution of the deviations of several of the model parameters estimated from 100 simulated DNA-microarray slides. </bold>The deviation is calculated as (estimate - true value) / (standard deviation of 100 estimates).</p></caption><graphic xlink:href="1471-2105-7-205-3"/></fig><fig position="float" id="F4"><label>Figure 4</label><caption><p><bold>Experiment-dependency of the parameters of the <italic>SIMAGE </italic>model. </bold>The bar-graph shows the CVs ((standard deviation / average) &#x000d7; 100%) of the parameters, estimated from the individual datasets. The resulting CV was determined from the average estimates for each of the parameters obtained from the experiments. The <italic>p</italic>-value obtained by ANOVA is displayed below the parameter symbols; <italic>p</italic>-values below 0.05 are considered to be significant.</p></caption><graphic xlink:href="1471-2105-7-205-4"/></fig><fig position="float" id="F5"><label>Figure 5</label><caption><p><bold>Visualization of the signals of a simulated slide. </bold>The upper picture shows a visualization of the measured expressions, while the lower picture is a visualization of the measured background signals. The areas designated as 'missing' are grey.</p></caption><graphic xlink:href="1471-2105-7-205-5"/></fig><fig position="float" id="F6"><label>Figure 6</label><caption><p><bold>Distribution of <italic>p</italic>-values of a DNA-microarray experiment simulated by <italic>SIMAGE</italic>. </bold>Data for 2200 genes, in 6 slides with technical duplicates hybridized in dye-swaps, was simulated using the MolGen experiment profile (supplementary Table T1) with some changes: <italic>&#x003c0;</italic><sub>- </sub>= 1% and <italic>&#x003c0;</italic><sub>+ </sub>= 2%, <italic>&#x003bc;</italic><sub>- </sub>= -2 and <italic>&#x003bc;</italic><sub>+ </sub>= 2), <italic>&#x003c3;</italic><sub><italic>bg </italic></sub>= 700, and <italic>s </italic>= 30 % &#x000d7; <italic>&#x003bc;</italic>. The main graph shows the resulting ratios after normalization plotted versus the <italic>p</italic>-value. The graph was simplified by removing genes with ratios between 2/3 and 3/2. The 66 genes for which differential expressions were modeled are depicted by blue diamonds. The remaining genes are depicted in purple squares. The small graph on the right demonstrates the reversed <italic>p</italic>-value dependency on the average signal for the 66 differentially expressed genes modeled. The average signal was calculated for each of the 66 genes over the maximum of 12 normalized measurements. Normalization was performed using Lowess normalization and differential expression tests were performed with the non-Bayesian Cyber-T implementation of a variant of the <italic>t</italic>-test [3]. The Cyber-T test provides the <italic>p</italic>-values, which indicate the probability that a given ratio is not differential caused by chance. Genes with less than 8 measurements were excluded from these tests and assigned a <italic>p</italic>-value of 1, in order to be able to present these genes in the graph.</p></caption><graphic xlink:href="1471-2105-7-205-6"/></fig><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>Comparison of the properties of different DNA-microarray simulation models described in literature. '+' and '-' indicate availability of the indicated feature in the specified model. Note that the modeling of features in the specific models is usually not the same.</p></caption><table frame="hsides" rules="groups"><thead><tr><td></td><td align="left">Method</td><td align="left"><italic>SIMAGE</italic>, this study</td><td align="left">Lalush <italic>et al. </italic>[23]</td><td align="left">Balagurunathan <italic>et al. </italic>[24]</td><td align="left">Lonnstedt <italic>et al. </italic>[25]</td><td align="left">Wierling <italic>et al. </italic>[26]</td><td align="left">GE2</td></tr></thead><tbody><tr><td align="left">model implementation</td><td align="left">tabulated gene expression data</td><td align="left">+</td><td align="left">-</td><td align="left">-</td><td align="left">-</td><td align="left">-</td><td align="left">+</td></tr><tr><td></td><td align="left">modeling of gene networks</td><td align="left">-</td><td align="left">-</td><td align="left">-</td><td align="left">-</td><td align="left">-</td><td align="left">+</td></tr><tr><td></td><td align="left">TIFF output</td><td align="left">-</td><td align="left">+</td><td align="left">+</td><td align="left">+</td><td align="left">+</td><td align="left">-</td></tr><tr><td></td><td align="left">software available</td><td align="left">+ [5]</td><td align="left">+ <sup>1</sup></td><td align="left">-</td><td align="left">-</td><td align="left">-</td><td align="left">+ [27]</td></tr><tr><td></td><td align="left">adjustable model</td><td align="left">+</td><td align="left">+</td><td align="left">+</td><td align="left">+</td><td align="left">-</td><td align="left">+/-</td></tr><tr><td align="left">model effects</td><td align="left">background surface pattern</td><td align="left">+</td><td align="left">-</td><td align="left">+</td><td align="left">-</td><td align="left">+</td><td align="left">-</td></tr><tr><td></td><td align="left">spot pin / grid effects</td><td align="left">+</td><td align="left">+</td><td align="left">+</td><td align="left">-</td><td align="left">-</td><td align="left">-</td></tr><tr><td></td><td align="left">channel effects</td><td align="left">+</td><td align="left">-</td><td align="left">+</td><td align="left">-</td><td align="left">-</td><td align="left">-</td></tr><tr><td></td><td align="left">non-linearity effects</td><td align="left">+</td><td align="left">-</td><td align="left">+</td><td align="left">-</td><td align="left">-</td><td align="left">+</td></tr><tr><td></td><td align="left">missing data</td><td align="left">+</td><td align="left">-</td><td align="left">+</td><td align="left">-</td><td align="left">-</td><td align="left">-</td></tr><tr><td></td><td align="left">'fishtailing'</td><td align="left">+</td><td align="left">-</td><td align="left">+</td><td align="left">-</td><td align="left">-</td><td align="left">+</td></tr><tr><td></td><td align="left">spot shape / size</td><td align="left">-</td><td align="left">+</td><td align="left">+</td><td align="left">-</td><td align="left">-</td><td align="left">-</td></tr></tbody></table><table-wrap-foot><p>1) C++ code available from author.</p></table-wrap-foot></table-wrap><table-wrap position="float" id="T2"><label>Table 2</label><caption><p>Overview of parameters in the <italic>SIMAGE </italic>model. Some parameters are known (such as number of spots per grid), others should be set by the user (the flag indicates when the parameter can also be estimated from the data). Details concerning these parameters are discussed in the implementation section.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">Parameter</td><td align="left">Description</td><td align="left">Can be estimated</td></tr></thead><tbody><tr><td align="left"><italic>n</italic><sub>
                              <italic>row</italic>
                           </sub></td><td align="left">Number of grids per row</td><td></td></tr><tr><td align="left"><italic>n</italic><sub>
                              <italic>col</italic>
                           </sub></td><td align="left">Number of grids per column</td><td></td></tr><tr><td align="left"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M44" name="1471-2105-7-205-i1" overflow="scroll">
                              <mml:semantics definitionURL="" encoding="">
                                 <mml:mrow>
                                    <mml:msubsup>
                                       <mml:mi>n</mml:mi>
                                       <mml:mrow>
                                          <mml:mi>s</mml:mi>
                                          <mml:mi>p</mml:mi>
                                          <mml:mi>o</mml:mi>
                                          <mml:mi>t</mml:mi>
                                       </mml:mrow>
                                       <mml:mn>2</mml:mn>
                                    </mml:msubsup>
                                 </mml:mrow>
                                 <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGUbGBdaqhaaWcbaGaem4CamNaemiCaaNaem4Ba8MaemiDaqhabaGaeGOmaidaaaaa@34E0@</mml:annotation>
                              </mml:semantics>
                           </mml:math></inline-formula></td><td align="left">Number of spots per grid</td><td></td></tr><tr><td align="left"><italic>n</italic><sub>
                              <italic>slide</italic>
                           </sub></td><td align="left">Number of slides</td><td></td></tr><tr><td align="left"><italic>n</italic><sub>
                              <italic>rep</italic>
                           </sub></td><td align="left">Number of technical replications</td><td></td></tr><tr><td align="left"><italic>n</italic><sub>
                              <italic>pin</italic>
                           </sub></td><td align="left">Number of spot pins</td><td></td></tr><tr><td align="left"><italic>&#x003bc;</italic></td><td align="left">Mean expression signal</td><td align="left">v</td></tr><tr><td align="left"><italic>&#x003bc;</italic><sub>-, </sub><italic>&#x003bc;</italic><sub>+</sub></td><td align="left">Logratio-shift due to down- and upregulation</td><td align="left">v</td></tr><tr><td align="left"><italic>&#x003c0;</italic><sub>-</sub>, <italic>&#x003c0;</italic><sub>+</sub></td><td align="left">Proportion of down-, up-regulated genes</td><td align="left">v</td></tr><tr><td align="left"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M45" name="1471-2105-7-205-i5" overflow="scroll">
                              <mml:semantics definitionURL="" encoding="">
                                 <mml:mrow>
                                    <mml:msubsup>
                                       <mml:mi>&#x003c3;</mml:mi>
                                       <mml:mi>G</mml:mi>
                                       <mml:mn>2</mml:mn>
                                    </mml:msubsup>
                                 </mml:mrow>
                                 <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaem4raCeabaGaeGOmaidaaaaa@30AC@</mml:annotation>
                              </mml:semantics>
                           </mml:math></inline-formula></td><td align="left">Variation in gene expression</td><td align="left">v</td></tr><tr><td align="left"><italic>&#x003c1;</italic></td><td align="left">Correlation between Cy3 and Cy5 expression</td><td align="left">v</td></tr><tr><td align="left"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M46" name="1471-2105-7-205-i7" overflow="scroll">
                              <mml:semantics definitionURL="" encoding="">
                                 <mml:mrow>
                                    <mml:msubsup>
                                       <mml:mi>&#x003c3;</mml:mi>
                                       <mml:mi>&#x003b5;</mml:mi>
                                       <mml:mn>2</mml:mn>
                                    </mml:msubsup>
                                 </mml:mrow>
                                 <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGae8xTdugabaGaeGOmaidaaaaa@3137@</mml:annotation>
                              </mml:semantics>
                           </mml:math></inline-formula></td><td align="left">Replication variation</td><td align="left">v</td></tr><tr><td align="left"><italic>n</italic><sub>
                              <italic>bg</italic>
                           </sub></td><td align="left">Number of background 'densities'</td><td></td></tr><tr><td align="left"><italic>&#x003c3;</italic><sub>
                              <italic>bg</italic>
                           </sub></td><td align="left">Mean standard deviation per background density</td><td></td></tr><tr><td align="left"><italic>s</italic></td><td align="left">Maximum slope of the linear tilt</td><td></td></tr><tr><td align="left"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M47" name="1471-2105-7-205-i11" overflow="scroll">
                              <mml:semantics definitionURL="" encoding="">
                                 <mml:mrow>
                                    <mml:msubsup>
                                       <mml:mi>&#x003c3;</mml:mi>
                                       <mml:mrow>
                                          <mml:mi>c</mml:mi>
                                          <mml:mi>h</mml:mi>
                                          <mml:mi>a</mml:mi>
                                          <mml:mi>n</mml:mi>
                                          <mml:mi>n</mml:mi>
                                          <mml:mi>e</mml:mi>
                                          <mml:mi>l</mml:mi>
                                       </mml:mrow>
                                       <mml:mn>2</mml:mn>
                                    </mml:msubsup>
                                 </mml:mrow>
                                 <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaem4yamMaemiAaGMaemyyaeMaemOBa4MaemOBa4MaemyzauMaemiBaWgabaGaeGOmaidaaaaa@3906@</mml:annotation>
                              </mml:semantics>
                           </mml:math></inline-formula></td><td align="left">Channel variation</td><td align="left">v</td></tr><tr><td align="left"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M48" name="1471-2105-7-205-i13" overflow="scroll">
                              <mml:semantics definitionURL="" encoding="">
                                 <mml:mrow>
                                    <mml:msubsup>
                                       <mml:mi>&#x003c3;</mml:mi>
                                       <mml:mrow>
                                          <mml:mi>p</mml:mi>
                                          <mml:mi>i</mml:mi>
                                          <mml:mi>n</mml:mi>
                                       </mml:mrow>
                                       <mml:mn>2</mml:mn>
                                    </mml:msubsup>
                                 </mml:mrow>
                                 <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaemiCaaNaemyAaKMaemOBa4gabaGaeGOmaidaaaaa@33BE@</mml:annotation>
                              </mml:semantics>
                           </mml:math></inline-formula></td><td align="left">Spot pin variation</td><td align="left">v</td></tr><tr><td align="left"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M49" name="1471-2105-7-205-i17" overflow="scroll">
                              <mml:semantics definitionURL="" encoding="">
                                 <mml:mrow>
                                    <mml:msubsup>
                                       <mml:mi>&#x003c3;</mml:mi>
                                       <mml:mi>X</mml:mi>
                                       <mml:mn>2</mml:mn>
                                    </mml:msubsup>
                                 </mml:mrow>
                                 <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaqhaaWcbaGaemiwaGfabaGaeGOmaidaaaaa@30CE@</mml:annotation>
                              </mml:semantics>
                           </mml:math></inline-formula></td><td align="left">Gene &#x000d7; dye variation</td><td></td></tr><tr><td align="left"><italic>&#x003b1;</italic><sub>1</sub></td><td align="left">Non-linearity parameter 'curvature'</td><td align="left">v</td></tr><tr><td align="left"><italic>&#x003b1;</italic><sub>2</sub></td><td align="left">Non-linearity parameter 'tilt'</td><td align="left">v</td></tr><tr><td align="left"><italic>&#x003b4;</italic></td><td align="left">Fishtailing parameter</td><td align="left">v</td></tr><tr><td align="left"><italic>w</italic></td><td align="left">Scanning device bias</td><td align="left">v</td></tr><tr><td align="left"><italic>n</italic><sub><italic>h</italic></sub>, <italic>n</italic><sub><italic>d</italic></sub>, <italic>n</italic><sub><italic>s</italic></sub></td><td align="left">Maximum number of hairs, donuts and missing spots</td><td></td></tr><tr><td align="left"><italic>l</italic><sub><italic>h</italic></sub>, <italic>l</italic><sub><italic>d</italic></sub></td><td align="left">Maximum length of hairs and radius of donuts</td><td></td></tr></tbody></table></table-wrap><table-wrap position="float" id="T3"><label>Table 3</label><caption><p>Estimation of parameters from the simulation of 100 DNA-microarray slides. The mentioned deviations are the number of estimated standard-deviations that the estimated mean, respectively median, lie away from the true value of the parameter.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">Parameter</td><td align="left">Deviation (mean)</td><td align="left">Deviation (median)</td></tr></thead><tbody><tr><td align="left"><italic>&#x003bc;</italic></td><td align="left">0.1</td><td align="left">0.1</td></tr><tr><td align="left"><italic>&#x003c3;</italic><sub>channel</sub></td><td align="left">-0.3</td><td align="left">-0.5</td></tr><tr><td align="left"><italic>&#x003c3;</italic><sub>pin</sub></td><td align="left">1.5</td><td align="left">1.5</td></tr><tr><td align="left"><italic>&#x003c3;</italic><sup>2</sup><sub>gene</sub></td><td align="left">-1.6</td><td align="left">-1.6</td></tr><tr><td align="left"><italic>&#x003c1;</italic></td><td align="left">-1.6</td><td align="left">-1.6</td></tr><tr><td align="left"><italic>&#x003c3;</italic><sub>
                              <italic>&#x003b5;</italic>
                           </sub></td><td align="left">-0.7</td><td align="left">-0.6</td></tr><tr><td align="left">|<italic>&#x003bc;</italic><sub>-</sub>|, <italic>&#x003bc;</italic><sub>+</sub></td><td align="left">-1.1</td><td align="left">-1.0</td></tr><tr><td align="left"><italic>&#x003c0;</italic><sub>-</sub>, <italic>&#x003c0;</italic><sub>+</sub></td><td align="left">1.0</td><td align="left">0.7</td></tr></tbody></table></table-wrap></sec></back></article>


